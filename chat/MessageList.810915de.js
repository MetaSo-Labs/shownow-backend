var Cs=Object.defineProperty,Ts=Object.defineProperties;var Ss=Object.getOwnPropertyDescriptors;var na=Object.getOwnPropertySymbols;var Ps=Object.prototype.hasOwnProperty,$s=Object.prototype.propertyIsEnumerable;var oa=(P,B,z)=>B in P?Cs(P,B,{enumerable:!0,configurable:!0,writable:!0,value:z}):P[B]=z,ia=(P,B)=>{for(var z in B||(B={}))Ps.call(B,z)&&oa(P,z,B[z]);if(na)for(var z of na(B))$s.call(B,z)&&oa(P,z,B[z]);return P},ca=(P,B)=>Ts(P,Ss(B));var G=(P,B,z)=>new Promise((we,de)=>{var _e=Q=>{try{re(z.next(Q))}catch(ne){de(ne)}},Me=Q=>{try{re(z.throw(Q))}catch(ne){de(ne)}},re=Q=>Q.done?we(Q.value):Promise.resolve(Q.value).then(_e,Me);re((z=z.apply(P,B)).next())});import{C as zs,g2 as Bs,g3 as da,d as Y,aG as Ls,N as Ns,j as T,M as m,o as l,v as L,w as D,S as ve,a,V as k,u as e,I as xe,y as Rs,m as v,c,W as ma,e as ua,t as d,F as K,b as x,X as fe,Y as ga,R as As,g4 as Es,$ as Us,aN as ye,a2 as Xs,i as pa,g as va,cy as le,di as js,df as ce,dl as Fs,dc as E,bf as N,r as qs,T as Hs,dg as ke,dj as Gs,Z as Ds,bh as Qs,cb as Vs,bi as xa,d4 as Ys,p as fa,n as ya,_ as he,fG as Be,fH as Js,fF as ka,eN as ha,eP as Os,h as Ws,q as Ks,bw as Zs,g5 as el,x as al,k as tl,aa as be,cI as ba,a5 as wa,aJ as sl,g6 as _a,ft as ll,bJ as rl,bg as nl,__tla as ol}from"./index.02fc6cc9.js";import{_ as Ma,M as il,N as cl,a as dl,P as ml,__tla as ul}from"./Publish.e9f8ac4b.js";import{_ as gl,__tla as pl}from"./modals.ca72ea17.js";import{_ as vl,__tla as xl}from"./ChannelBody.c476d0ed.js";import{__tla as fl}from"./Sticker.a2ddf828.js";import{__tla as yl}from"./index.7debbede.js";import{__tla as kl}from"./popover.bf3e6abc.js";let Ia,hl=Promise.all([(()=>{try{return ol}catch(P){}})(),(()=>{try{return ul}catch(P){}})(),(()=>{try{return pl}catch(P){}})(),(()=>{try{return xl}catch(P){}})(),(()=>{try{return fl}catch(P){}})(),(()=>{try{return yl}catch(P){}})(),(()=>{try{return kl}catch(P){}})()]).then(()=>G(void 0,null,function*(){const P=["light","dark"],B=zs({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Bs(da),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:P,default:"light"}}),z={close:s=>s instanceof MouseEvent},we=Y({name:"ElAlert"}),de=Y(ca(ia({},we),{props:B,emits:z,setup(s,{emit:I}){const n=s,{Close:$}=Es,b=Ls(),f=Ns("alert"),C=T(!0),g=m(()=>da[n.type]),R=m(()=>[f.e("icon"),{[f.is("big")]:!!n.description||!!b.default}]),w=m(()=>({[f.is("bold")]:n.description||b.default})),U=u=>{C.value=!1,I("close",u)};return(u,p)=>(l(),L(ga,{name:e(f).b("fade"),persisted:""},{default:D(()=>[ve(a("div",{class:k([e(f).b(),e(f).m(u.type),e(f).is("center",u.center),e(f).is(u.effect)]),role:"alert"},[u.showIcon&&e(g)?(l(),L(e(xe),{key:0,class:k(e(R))},{default:D(()=>[(l(),L(Rs(e(g))))]),_:1},8,["class"])):v("v-if",!0),a("div",{class:k(e(f).e("content"))},[u.title||u.$slots.title?(l(),c("span",{key:0,class:k([e(f).e("title"),e(w)])},[ma(u.$slots,"title",{},()=>[ua(d(u.title),1)])],2)):v("v-if",!0),u.$slots.default||u.description?(l(),c("p",{key:1,class:k(e(f).e("description"))},[ma(u.$slots,"default",{},()=>[ua(d(u.description),1)])],2)):v("v-if",!0),u.closable?(l(),c(K,{key:2},[u.closeText?(l(),c("div",{key:0,class:k([e(f).e("close-btn"),e(f).is("customed")]),onClick:U},d(u.closeText),3)):(l(),L(e(xe),{key:1,class:k(e(f).e("close-btn")),onClick:U},{default:D(()=>[x(e($))]),_:1},8,["class"]))],64)):v("v-if",!0)],2)],2),[[fe,C.value]])]),_:3},8,["name"]))}}));var _e=As(de,[["__file","/home/runner/work/element-plus/element-plus/packages/components/alert/src/alert.vue"]]);const Me=Us(_e),re={class:"animate-pulse flex space-x-4 w-full py-4"},Q=a("div",{class:"h-0 w-1/5 w-2/5 w-3/5 w-4/5 w-5/5 hidden"},null,-1),ne=a("div",{class:"rounded-3xl bg-gray-300 dark:bg-gray-600 h-13.5 w-13.5"},null,-1),Ca={class:"flex-1 space-y-4 py-1"},Ta=a("div",{class:"h-2.5 bg-gray-300 dark:bg-gray-600 rounded w-1/4 max-w-[200PX]"},null,-1),Sa={class:"space-y-3"},Pa=a("div",{class:"grid grid-cols-4 gap-4"},[a("div",{class:"h-2.5 bg-gray-200 dark:bg-gray-700 rounded col-span-2"})],-1),$a=a("div",{class:"h-2.5 bg-gray-300 dark:bg-gray-600 rounded w-1/4"},null,-1),za=Y({__name:"LoadingItem",setup(s){const I=m(()=>`w-${Math.floor(Math.random()*4)+1}/5`);return(n,$)=>(l(),c("div",re,[Q,ne,a("div",Ca,[Ta,a("div",Sa,[Pa,$a,a("div",{class:k(["h-2.5 bg-gray-200 dark:bg-gray-700 rounded",e(I)])},null,2)])])]))}}),Ba={class:"overflow-x-hidden overflow-y-hidden py-4 space-y-4 px-4"},La=Y({__name:"LoadingList",props:{itemCount:{type:Number,default:6}},setup(s){const I=s,n=T([]);for(let $=1;$<=I.itemCount;$++)n.value.push($);return($,b)=>(l(),c("div",Ba,[(l(!0),c(K,null,ye(n.value,f=>(l(),L(za))),256))]))}}),Na="/chat/red-envelope.f2e185e2.svg",Ra=s=>(fa("data-v-fc9bd53d"),s=s(),ya(),s),Aa={class:"flex"},Ea={key:0,class:"w-full"},Ua={key:1,class:"my-1.5 flex"},Xa={key:2,class:"my-1.5 flex"},ja={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},Fa={class:"rounded-xl p-4 flex space-x-4.5 bg-white dark:bg-gray-700 items-center rounded-tl border border-solid border-blue-400"},qa={class:"flex flex-col space-y-1.5"},Ha={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},Ga={class:"text-dark-400 dark:text-gray-200 text-xs"},Da={class:"flex py-2.5 items-center space-x-1.5 px-4"},Qa={class:"text-white text-xs"},Va={key:3,class:"my-1.5 flex"},Ya={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},Ja={class:"rounded-xl p-4 flex space-x-4.5 bg-white dark:bg-gray-700 items-center rounded-tl border border-solid border-blue-400"},Oa={class:"flex flex-col space-y-1"},Wa={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},Ka={key:0,class:"text-dark-400 dark:text-gray-200 text-xs"},Za={class:"flex py-2.5 items-center space-x-1.5 px-4"},et={class:"text-white text-xs"},at={key:4,class:"my-1.5 flex flex-col items-start"},tt={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},st={class:"flex items-center gap-x-4.5 mb-3"},lt={class:"flex flex-col space-y-1"},rt={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},nt={key:0,class:"text-dark-400 dark:text-gray-200 text-xs"},ot={class:"pt-3 flex justify-between items-center"},it={class:"text-xs text-dark-300 dark:text-gray-400"},ct={class:"text-sm"},dt={class:"flex py-2.5 items-center space-x-1.5 px-4"},mt={class:"text-white text-xs"},ut={class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},gt={key:5,class:"my-1.5 flex flex-col items-start"},pt={key:0,class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},vt={key:6,class:"my-1.5 flex flex-col items-start"},xt={key:0,class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 break-all text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},ft={key:7,class:"my-1.5 flex flex-col items-start"},yt={key:8,class:"my-1.5 flex flex-col items-start"},kt={class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 break-all text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},ht=["title"],bt={key:10,class:"text-xs text-dark-400 dark:text-gray-200 my-0.5 capitalize"},wt={class:"max-w-full md:max-w-[50%] lg:max-w-[400px] shadow-lg rounded-xl cursor-pointer origin-top-left hover:shadow-xl hover:scale-105 transition-all duration-300"},_t={class:"rounded-xl bg-red-400 p-6 flex space-x-2"},Mt=["src"],It={class:""},Ct={class:"text-white text-lg font-medium capitalize"},Tt={class:"text-red-50 text-xs mt-0.5"},St=Ra(()=>a("div",{class:"py-2 px-6 text-dark-400 dark:text-gray-200 text-xs"},"Show\u7EA2\u5305",-1)),Pt={class:"p-4 space-y-3"},$t={class:"flex items-center space-x-3"},zt={class:""},Bt={class:"flex-1 min-w-0"},Lt={class:"text-dark-800 dark:text-gray-100 font-medium text-base truncate max-w-[200px]"},Nt={class:"text-dark-400 dark:text-gray-400 text-sm"},Rt={class:"flex gap-4 items-center"},At={class:"text-dark-400 dark:text-gray-400 text-xs mt-1 truncate max-w-[150px]"},Et={key:0,class:"text-dark-400 dark:text-gray-400 text-xs mt-1"},Ut={class:"pt-2 border-t border-gray-200 dark:border-gray-600"},Xt={class:"main-border bg-primary hover:bg-primary-dark text-black text-center py-2 px-4 rounded-lg transition-colors duration-200 font-medium"},jt=["innerHTML"],Ft={class:"text-xxs text-dark-300 dark:text-gray-400 mt-1 underline"},qt=["innerHTML"],Ht={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-700 inline-block opacity-50"},Gt=["title"],Dt={key:0,class:"text-[#fc457b] flex-1 font-sm mr-2"},Qt=Y({__name:"MessageItemForSession",props:{message:null},emits:["quote","toBuzz","to-time-stamp"],setup(s,{emit:I}){const n=s,$=Xs("Reply"),b=pa(),f=T(!1),C=T(null),g=va(),R=le(),w=m(()=>R.activeChannel);js();const U=T("hidden"),u=T("");m(()=>{var t,r,y;return n.message.from===((t=g.user)==null?void 0:t.metaId)?(r=g.user)==null?void 0:r.name:(y=w.value)==null?void 0:y.name});const p=m(()=>n.message.chain);m(()=>{var t,r,y;return n.message.from===((t=g.user)==null?void 0:t.metaId)?(r=g.user)==null?void 0:r.metaName:(y=w.value)==null?void 0:y.metaName});const J=()=>{f.value=!0},V=m(()=>b.t("Talk.Messages.resend")),Z=m(()=>{const t=ce(n.message.content,n.message.encryption,n.message.protocol,n.message.isMock,!0),r=/\/channels\/public\/([a-f0-9]+)/i,y=r.test(t);if(y&&!C.value){const S=t==null?void 0:t.match(r);if(S){const h=S[1];ee(h+"i0")}}return y}),ee=t=>G(this,null,function*(){try{const r=yield Fs(t);C.value=r}catch(r){}}),ae=()=>{const t=X.value;t.fullUrl&&window.open(t.fullUrl,"_self")},X=m(()=>{var S,h,A,M,q;const t=ce(n.message.content,n.message.encryption,n.message.protocol,n.message.isMock,!0),r=/\/channels\/public\/([a-f0-9]+)/i,y=t==null?void 0:t.match(r);return y?{pinId:y[1],groupName:(S=C.value)==null?void 0:S.roomName,groupAvatar:((h=C.value)==null?void 0:h.roomIcon)||"",memberCount:((A=C.value)==null?void 0:A.userCount)||0,fullUrl:t,creator:((q=(M=C.value)==null?void 0:M.createUserInfo)==null?void 0:q.name)||""}:{pinId:"",groupName:"Group Chat",groupAvatar:"",memberCount:0,creator:"",fullUrl:t}}),te=()=>G(this,null,function*(){}),j=m(()=>R.activeChannel.publicKeyStr),O=m(()=>{var t,r;if(n.message.isMock)return n.message.content;if(n.message.encryption!=="1")return((t=n.message.data)==null?void 0:t.attachment)||((r=n.message)==null?void 0:r.content)}),F=t=>{if(typeof t>"u")return"";const r=/<\/?.+?>/gi,y=/document\.cookie/gi,S=/(http|https):\/\//gi,h=/(f|ht){1}(tp|tps):\/\/([\w-]+\S)+[\w-]+([\w-?%#&=]*)?(\/[\w- ./?%#&=]*)?/g;return r.test(t)?"\u65E0\u6548\u8F93\u5165,\u522B\u800D\u82B1\u6837!":y.test(t)?"\u65E0\u6548\u8F93\u5165,\u4F60\u60F3\u5E72\u561B!":(t=t.replace(h,function(A){return S.test(t)?`<a href=${A} target="_blank" style="text-decoration: underline;cursor: pointer;word-break: break-all;" class="url"> ${A} </a>`:`<a onClick="window.open('http://${t}','_blank')" style="text-decoration: underline;cursor: pointer;word-break: break-all;" target="_blank">${t}</a>`}),t=t.replace(/\\n/g,`
`),t.replace(/\n/g,"<br />"))},oe=m(()=>{var S;const t=n.message.content;if(!t)return"";if(n.message.metaId===((S=n.message.data)==null?void 0:S.redEnvelopeMetaId))return b.t("Talk.Channel.receive_own_red_envelope");const[r,y]=t.split("|-|");return b.t("Talk.Channel.receive_red_envelope",{sender:y})}),me=m(()=>{var t;return((t=n.message.data)==null?void 0:t.content)||b.t("Talk.Channel.default_red_envelope_message")}),_=m(()=>{var t,r;return((t=g.last)==null?void 0:t.metaid)&&((r=g.last)==null?void 0:r.metaid)===n.message.from}),Ie=m(()=>{var t,r,y;return n.message.from===((t=g.last)==null?void 0:t.metaid)?(r=g.last)==null?void 0:r.avatar:(y=w.value)==null?void 0:y.avatar}),ue=m(()=>{var t,r,y,S;if((r=(t=n.message.data)==null?void 0:t.sellUtxo)!=null&&r.price){let h=(((S=(y=n.message.data)==null?void 0:y.sellUtxo)==null?void 0:S.price)/1e8).toFixed(8);return h=h.replace(/0+$/,""),h=h+" SPACE",h}return"-"}),se=m(()=>E(n.message.protocol,N.SimpleEmojiGroupChat)),W=m(()=>E(n.message.protocol,N.SimpleFileMsg)),Ce=m(()=>E(n.message.protocol,N.SimpleGroupLuckyBag)),Te=m(()=>E(n.message.protocol,N.OpenRedenvelope)),Se=m(()=>E(n.message.protocol,N.SimpleMsg)),Pe=m(()=>E(n.message.protocol,N.PayLike)),$e=m(()=>E(n.message.protocol,N.PayFollow)),ge=m(()=>E(n.message.protocol,N.SimpleRePost)),ie=m(()=>E(n.message.nodeName,N.SimpleMicroblog)),ze=m(()=>E(n.message.protocol,N.PayComment)),pe=m(()=>E(n.message.protocol,N.FtTransfer)),o=m(()=>E(n.message.protocol,N.NftTransfer)),i=m(()=>E(n.message.protocol,N.nftBuy));return(t,r)=>{var Ne,Re,Ae,Ee,Ue,Xe,je,Fe,qe,He,Ge,De,Qe,Ve,Ye,Je,Oe,We,Ke,Ze,ea,aa,ta,sa,la,ra;const y=Qs,S=Vs,h=xa,A=Ys,M=qs("RouterLink"),q=gl;return l(),c("div",{class:k(["lg:hover:bg-gray-200 lg:dark:hover:bg-gray-950 px-4 py-1.5 relative group transition-all duration-150",{replying:((Ne=e($).val)==null?void 0:Ne.timestamp)===s.message.timestamp}])},[v(" \u6D88\u606F\u83DC\u5355 "),e(Se)?(l(),L(Ma,{key:0,message:n.message,parsed:F(e(ce)((Re=s.message)==null?void 0:Re.content,(Ae=s.message)==null?void 0:Ae.encryption,(Ee=s.message)==null?void 0:Ee.protocol,(Ue=s.message)==null?void 0:Ue.isMock,!0)),translateStatus:U.value,"onUpdate:translateStatus":r[0]||(r[0]=H=>U.value=H),translatedContent:u.value,"onUpdate:translatedContent":r[1]||(r[1]=H=>u.value=H),onQuote:r[2]||(r[2]=H=>I("quote",H)),onToBuzz:r[3]||(r[3]=H=>I("toBuzz",H)),isMyMessage:e(_)},null,8,["message","parsed","translateStatus","translatedContent","isMyMessage"])):(l(),L(Ma,{key:1,isMyMessage:e(_),message:n.message,onQuote:r[4]||(r[4]=H=>I("quote",H)),onToBuzz:r[5]||(r[5]=H=>I("toBuzz",H))},null,8,["isMyMessage","message"])),v(" Quout "),s.message.replyInfo?(l(),L(il,Hs({key:2,quote:{avatarImage:(je=(Xe=s.message.replyInfo)==null?void 0:Xe.userInfo)==null?void 0:je.avatarImage,metaName:"",metaId:(qe=(Fe=s.message.replyInfo)==null?void 0:Fe.userInfo)==null?void 0:qe.metaid,nickName:s.message.replyInfo.userInfo.name,protocol:s.message.replyInfo.protocol,content:(e(E)(s.message.replyInfo.protocol,e(N).SimpleFileMsg),s.message.replyInfo.content),encryption:s.message.replyInfo.encryption,timestamp:s.message.replyInfo.timestamp,isMock:s.message.isMock,index:s.message.replyInfo.index},isSession:!0},t.$attrs,{isMyMessage:e(_)}),null,16,["quote","isMyMessage"])):v("v-if",!0),a("div",{class:k(["flex",[e(_)?"flex-row-reverse":""]])},[x(y,{image:e(Ie),"meta-id":"undefined",name:(Ge=(He=s.message)==null?void 0:He.fromUserInfo)==null?void 0:Ge.name,"meta-name":"",class:"w-10 h-10 lg:w-13.5 lg:h-13.5 shrink-0 select-none",disabled:!0},null,8,["image","name"]),a("div",{class:k(["grow",[e(_)?"mr-2 lg:mr-4 pl-8 lg:pl-12":"ml-2 lg:ml-4 pr-8 lg:pr-12"]])},[a("div",{class:k(["flex space-x-2",[e(_)?"flex-row-reverse items-center":"items-baseline"]])},[x(S,{name:(Qe=(De=s.message)==null?void 0:De.fromUserInfo)==null?void 0:Qe.name,"meta-name":"","text-class":"text-sm font-medium dark:text-gray-100",class:k([e(_)?"ml-2":""])},null,8,["name","class"]),a("div",{class:k(["text-xs shrink-0 flex whitespace-nowrap items-center",[e(_)?"flex-row-reverse  justify-center":"gap-1 ",e(p)==e(ke).btc?"text-[#EBA51A]":"text-dark-300 dark:text-gray-400"]])},[a("span",null,d(e(Gs)(s.message.timestamp,e(b))),1),a("div",Aa,[e(p)==e(ke).btc?(l(),L(h,{key:0,name:"btc",class:k(["chain-icon-menu w-[16px] h-[16px]",e(_)?"mr-1":""])},null,8,["class"])):v("v-if",!0),v(` <img
              :src="btcIcon"
              
             
              
            /> `)])],2)],2),e(se)?(l(),c("div",Ea,[x(A,{src:e(ce)((Ve=s.message)==null?void 0:Ve.content,(Ye=s.message)==null?void 0:Ye.encryption,(Je=s.message)==null?void 0:Je.protocol,(Oe=s.message)==null?void 0:Oe.isMock,!0),customClass:"max-w-[80%] md:max-w-[50%] lg:max-w-[320px] py-0.5 object-scale-down"},null,8,["src"]),x(cl,{class:"w-8 mt-1"})])):e($e)?(l(),c("div",Ua,[a("div",{class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(h,{name:"message_follow",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.follow")),1)],2)])):e(pe)?(l(),c("div",Xa,[a("div",ja,[a("div",Fa,[x(A,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",qa,[a("div",Ha,d(s.message.memo),1),a("div",Ga,d(s.message.amountStr.split(".")[0]+" "+s.message.symbol),1)])]),a("div",Da,[x(h,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",Qa,d(t.$t("Talk.Messages.token_transfer")),1)])])])):e(o)?(l(),c("div",Va,[a("div",Ya,[a("div",Ja,[x(A,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",Oa,[a("div",Wa,d(s.message.memo),1),s.message.data?(l(),c("div",Ka," # "+d(s.message.data.tokenIndex),1)):v("v-if",!0)])]),a("div",Za,[x(h,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",et,d(t.$t("Talk.Messages.nft_transfer")),1)])])])):e(i)?(l(),c("div",at,[a("div",tt,[x(M,{to:{name:"nftDetail",params:{tokenIndex:s.message.data.tokenIndex,genesis:(We=s.message.data)==null?void 0:We.genesis,codehash:(Ke=s.message.data)==null?void 0:Ke.codehash,chain:"mvc"}},class:"block rounded-xl p-4 bg-white dark:bg-gray-700 rounded-tl border border-solid border-blue-400 divide-y divide-dark-200 dark:divide-gray-600"},{default:D(()=>[a("div",st,[x(A,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",lt,[a("div",rt,d(s.message.memo),1),s.message.data?(l(),c("div",nt," # "+d(s.message.data.tokenIndex),1)):v("v-if",!0)])]),a("div",ot,[a("div",it,d(t.$t("Talk.Messages.price")),1),a("div",ct,d(e(ue)),1)])]),_:1},8,["to"]),a("div",dt,[x(h,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",mt,d(t.$t("Talk.Messages.nft_buy")),1)])]),a("div",ut,d(t.$t("Talk.Messages.buy_tip")),1)])):e(ge)?(l(),c("div",gt,[a("div",{class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(h,{name:"message_repost",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.repost")),1)],2),s.message.data.rePostComment?(l(),c("div",pt,d(s.message.data.rePostComment),1)):v("v-if",!0)])):e(ie)?(l(),c("div",vt,[a("div",{class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(h,{name:"message_repost",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.repost_with_comment")),1)],2),s.message.data.content?(l(),c("div",xt,d(s.message.data.content),1)):v("v-if",!0)])):e(Pe)?(l(),c("div",ft,[a("div",{class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(h,{name:"message_like",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.like")),1)],2)])):e(ze)?(l(),c("div",yt,[a("div",{class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(h,{name:"message_comment",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.comment")),1)],2),a("div",kt,d(s.message.data.content),1)])):e(W)?(l(),c("div",{key:9,class:k(["w-full py-0.5 flex items-center",[e(_)?"flex-row-reverse":""]])},[a("div",{class:k(["w-fit max-w-[90%] md:max-w-[50%] lg:max-w-[235PX] max-h-[600PX] overflow-y-hidden rounded bg-transparent cursor-pointer transition-all duration-200",[s.message.error&&"opacity-50"]]),onClick:J},[x(A,{src:e(O),isPrivateChat:!0,chatPubkeyForDecrypt:e(j),customClass:"rounded py-0.5 object-scale-down"},null,8,["src","chatPubkeyForDecrypt"])],2),s.message.error?(l(),c("button",{key:0,class:"ml-3",title:e(V),onClick:te},[x(h,{name:"arrow_path",class:"w-4 h-4 text-dark-400 dark:text-gray-200 hover:animate-spin-once"})],8,ht)):v("v-if",!0),e(W)&&f.value?(l(),L(Ds,{key:1,to:"body"},[f.value?(l(),L(vl,{key:0,src:s.message.content,isPrivateChat:!0,chatPubkeyForDecrypt:e(j),onClose:r[6]||(r[6]=H=>f.value=!1)},null,8,["src","chatPubkeyForDecrypt"])):v("v-if",!0)])):v("v-if",!0)],2)):e(Te)?(l(),c("div",bt,d(e(oe)),1)):e(Ce)?(l(),c("div",{key:11,class:k(["w-full flex py-0.5",[e(_)?"flex-row-reverse":""]])},[a("div",wt,[a("div",_t,[a("img",{src:e(Na),class:"h-12",loading:"lazy"},null,8,Mt),a("div",It,[a("div",Ct,d(t.$t("Talk.Channel.come_get_red_envelope")),1),a("div",Tt,d(e(me)),1)])]),St])],2)):e(Z)?(l(),c(K,{key:12},[v(" \u7FA4\u804A\u9080\u8BF7\u94FE\u63A5 "),a("div",{class:k(["w-full flex py-0.5",[e(_)?"flex-row-reverse":""]])},[a("div",{class:"max-w-full sm:max-w-[300px] shadow rounded-xl cursor-pointer transition-all duration-200 bg-white dark:bg-gray-700 hover:shadow-md group",onClick:ae},[a("div",Pt,[v(" \u7FA4\u5934\u50CF\u548C\u57FA\u672C\u4FE1\u606F "),a("div",$t,[a("div",zt,[x(q,{src:e(X).groupAvatar,alt:e(X).groupName,"custom-class":"w-12 h-12 min-w-12 min-h-12 rounded-full",size:48},null,8,["src","alt"])]),a("div",Bt,[a("div",Lt,d(e(X).groupName||"Group Chat"),1),a("div",Nt,d(((Ze=n.message.userInfo)==null?void 0:Ze.name)||"Someone")+" "+d(t.$t("share_group_invites")),1)])]),a("div",Rt,[a("div",At,d(t.$t("share_group_creator"))+": "+d(e(X).creator),1),e(X).memberCount>0?(l(),c("div",Et,d(t.$t("share_group_member"))+": "+d(e(X).memberCount),1)):v("v-if",!0)]),v(" \u67E5\u770B\u7FA4\u7EC4\u6309\u94AE "),a("div",Ut,[a("div",Xt,d(t.$t("share_group_view")),1)])])])],2)],2112)):(l(),c("div",{key:13,class:k(["my-1.5 max-w-full flex",[e(_)?"flex-row-reverse":""]])},[U.value==="showing"?(l(),c("div",{key:0,class:k(["text-sm text-dark-800 dark:text-gray-100 font-normal p-3 rounded-xl transition-all duration-200",[e(p)==e(ke).btc&&"btc-item",e(_)?"bg-primary dark:text-gray-800 rounded-tr":"not-mine bg-white dark:bg-gray-700 rounded-tl",s.message.error&&"bg-red-200 dark:bg-red-700 opacity-50"]])},[a("div",{class:"",innerHTML:u.value},null,8,jt),a("div",Ft,d(t.$t("Talk.Messages.translated")),1)],2)):(l(),c("div",{key:2,class:k(["flex items-center gap-2 text-sm text-dark-800 dark:text-gray-100 font-normal p-3 rounded-xl transition-all duration-200",[e(p)==e(ke).btc&&"btc-item",e(_)?"bg-primary dark:text-gray-800 rounded-tr":"not-mine bg-white dark:bg-gray-700 rounded-tl",s.message.error&&"bg-red-200 dark:bg-red-700 opacity-50"]])},[a("div",{class:"whitespace-pre-wrap",innerHTML:F(e(ce)((ea=s.message)==null?void 0:ea.content,(aa=s.message)==null?void 0:aa.encryption,(ta=s.message)==null?void 0:ta.protocol,(sa=s.message)==null?void 0:sa.isMock,!0))},null,8,qt),s.message.mockId&&!s.message.error?(l(),c("div",Ht)):v("v-if",!0)],2)),s.message.error?(l(),c("button",{key:3,class:"ml-3 break-words flex items-center justify-center",title:e(V),onClick:te},[(la=s.message)!=null&&la.error?(l(),c("span",Dt,d((ra=s.message)==null?void 0:ra.error),1)):v("v-if",!0),x(h,{name:"arrow_path",class:"w-4 h-4 flex-1 text-dark-400 dark:text-gray-200 hover:animate-spin-once"})],8,Gt)):v("v-if",!0)],2))],2)],2)],2)}}}),Vt=he(Qt,[["__scopeId","data-v-fc9bd53d"]]),Yt="/chat/sub-channel.9be40439.svg",Jt={key:0,class:"broadcast-chat-header bg-white dark:bg-gray-700 text-dark-800 dark:text-white"},Ot=["onClick"],Wt={class:"broadcast-icon"},Kt=["src"],Zt={class:"broadcast-content"},es={class:"broadcast-title text-base"},as={key:0,class:"broadcast-description text-xs flex items-center"},ts={class:"text-dark-300 dark:text-gray-400"},ss={class:"text-dark-300 dark:text-gray-400"},ls={class:k(["main-border","primary"])},rs={key:1,class:k(["main-border","primary"])},ns=Y({__name:"BroadcastChatHeader",setup(s){const I=le(),n=pa(),$=m(()=>I.currSubChannels),b=(g,R,w)=>{let U=(w==null?void 0:w.substring(0,16))||"";switch(g){case Be.msg:return Js(R,U);case Be.red:return R;case Be.img:return`[${n.t("new_msg_img")}]`;default:return""}},f=g=>{I.enterSubGroupChat(g)},C=g=>{if(!g.lastMessage||typeof g.lastMessage.index!="number")return 0;const R=I.getLastReadIndex(g.id),w=g.lastMessage.index-R;return Math.max(0,w)};return(g,R)=>{const w=xa,U=ka;return e($).length>0?(l(),c("div",Jt,[(l(!0),c(K,null,ye(e($),u=>{var p,J,V,Z,ee,ae;return l(),c("div",{class:"broadcast-chat-container",key:u.id,onClick:X=>f(u.id)},[a("div",Wt,[a("img",{src:e(Yt),alt:""},null,8,Kt)]),a("div",Zt,[a("div",es,d(u.name||"# Broadcast Chat"),1),(p=u.lastMessage)!=null&&p.sender?(l(),c("div",as,[a("span",ts,d(((J=u.lastMessage)==null?void 0:J.senderName)||((Z=(V=u.lastMessage)==null?void 0:V.sender)==null?void 0:Z.slice(0,6))||"")+":",1),a("span",ss,d(b((ee=u.lastMessage)==null?void 0:ee.type,(ae=u.lastMessage)==null?void 0:ae.content,u.id)),1)])):v("v-if",!0)]),C(u)>0?(l(),L(U,{key:0,value:C(u),class:"item",max:9999,"show-zero":!1},{default:D(()=>[a("div",ls,[x(w,{name:"arrow_right",class:"cursor-pointer hover:text-gray-700 w-8 h-8"})])]),_:2},1032,["value"])):(l(),c("div",rs,[x(w,{name:"arrow_right",class:"cursor-pointer hover:text-gray-700 w-8 h-8"})]))],8,Ot)}),128))])):v("v-if",!0)}}}),os=he(ns,[["__scopeId","data-v-90151149"]]),is={class:"broadcast-chat-container"},cs={class:"broadcast-icon hover:scale-110"},ds={class:"broadcast-content"},ms={class:"broadcast-title text-base flex items-start flex-col"},us={key:0,class:"text-xs text-dark-300 drak:text-dark-400"},gs=Y({__name:"BroadcastChatHeaderBack",setup(s){const I=le(),{activeChannel:n}=ha(le());m(()=>I.currSubChannels);const $=()=>{I.setActiveChannel(I.activeChannel.parentGroupId)},b=m(()=>I.getParentGroupChannel(n.value.id)),f=m(()=>b.value&&b.value.lastMessage&&typeof b.value.lastMessage.index=="number"&&typeof b.value.lastReadIndex=="number"&&b.value.lastMessage.index-b.value.lastReadIndex>0?b.value.lastMessage.index-b.value.lastReadIndex:0);return(C,g)=>{var w;const R=xe;return((w=e(I).activeChannel)==null?void 0:w.type)==="sub-group"?(l(),c("div",{key:0,class:"broadcast-chat-header bg-white dark:bg-gray-700 text-dark-800 dark:text-white",onClick:$},[a("div",is,[a("div",cs,[x(R,null,{default:D(()=>[x(e(Os))]),_:1})]),a("div",ds,[a("div",ms,[a("span",null,d(C.$t("sub_channel_back_main")),1),e(f)?(l(),c("span",us,d(e(f))+" "+d(C.$t("sub_channel_header_message")),1)):v("v-if",!0)])])])])):v("v-if",!0)}}}),ps=he(gs,[["__scopeId","data-v-0f39eb16"]]),Le=s=>(fa("data-v-20e084c1"),s=s(),ya(),s),vs={key:0,class:"h-full overflow-y-hidden"},xs={class:"app-container"},fs={class:"loader"},ys=Le(()=>a("div",{class:"spinner"},null,-1)),ks=[ys],hs={class:"w-10 h-10 min-h-10 min-w-10 bg-white dark:bg-gray-700 shadow-md rounded-full flex items-center justify-center"},bs={key:1,class:"w-10 h-10 min-h-10 min-w-10 bg-white dark:bg-gray-700 shadow-md rounded-full flex items-center justify-center"},ws={class:"loader"},_s=Le(()=>a("div",{class:"spinner"},null,-1)),Ms=[_s],Is=Y({__name:"MessageList",props:{isSendRedPacketinProgress:Boolean},emits:["quote"],setup(s,{expose:I,emit:n}){const $=T(!1),b=T(!1),f=T(!1),C=T(!1),g=T(null),R=T(null),w=T(null);T(0);const U=T(0),u=va(),p=le(),J=Ws();Ks();const V=T(!1);Zs();const Z=T(""),ee=T(),ae=el(),X=T();al();const te=T(!1),{activeChannel:j}=ha(le()),O=T(new Map),F=T(null);m(()=>{var o,i,t;return((o=p.activeChannelMessages[p.activeChannelMessages.length-1])==null?void 0:o.index)!==((t=(i=p.activeChannel)==null?void 0:i.lastMessage)==null?void 0:t.index)});const oe=()=>G(this,null,function*(){W.value>0&&(yield p.loadNewestMessages(p.activeChannelId),yield be(),yield ll(100)),g.value&&(g.value.scrollTop=0)}),me=(o,i)=>{o&&o.$el?O.value.set(i.index||0,o.$el):o&&O.value.set(i.index||0,o)},_=()=>{F.value&&F.value.disconnect(),F.value=new IntersectionObserver(o=>{o.forEach(i=>{if(i.isIntersecting){const t=i.target,r=parseInt(t.getAttribute("data-message-index")||"0");p.activeChannelId&&r>=0&&p.setLastReadIndex(p.activeChannelId,r).catch(y=>{})}})},{root:g.value,rootMargin:"0px",threshold:0})},Ie=()=>{!F.value||(F.value.disconnect(),_(),O.value.forEach((o,i)=>{o&&F.value&&(o.setAttribute("data-message-index",i.toString()),F.value.observe(o))}))},ue=m(()=>{if(p.isInitialized){const o=p.activeChannel;return(o==null?void 0:o.type)==="private"?"session":o==null?void 0:o.type}return"group"}),se=(o=!1)=>G(this,null,function*(){var y;if(((y=j.value)==null?void 0:y.isTemporary)||$.value||f.value)return;if(o){if(C.value)return;f.value=!0}else{if(b.value)return;$.value=!0}let i=0;o&&w.value&&(i=w.value.scrollHeight);const t=p.activeChannelMessages.length;try{o?yield p.loadMoreNewestMessages(p.activeChannelId):yield p.loadMoreMessages(p.activeChannelId)}catch(S){}yield be();const r=p.activeChannelMessages.length;if(t===r&&(o?C.value=!0:b.value=!0),o&&w.value&&g.value){const S=w.value.scrollHeight;g.value.scrollTop=i-S}$.value=!1,f.value=!1,setTimeout(()=>{C.value=!1},1e3)}),W=m(()=>j.value&&j.value.lastMessage&&typeof j.value.lastMessage.index=="number"&&typeof j.value.lastReadIndex=="number"?j.value.lastMessage.index-j.value.lastReadIndex:0),Ce=o=>{const i=o.target;if(i)try{Math.abs(i.scrollTop)<50&&!C.value&&!f.value&&se(!0),Math.abs(i.scrollTop)>500?te.value=!0:te.value=!1;const t=100;i.scrollHeight-Math.abs(i.scrollTop)-i.clientHeight<t&&se(!1).catch(r=>{})}catch(t){}},Te=o=>{const i=g.value;!i||o.deltaY>0&&Math.abs(i.scrollTop)<10&&!C.value&&!f.value&&se(!0)},Se=o=>{o.touches.length>0&&(U.value=o.touches[0].clientY)},Pe=o=>{const i=g.value;!i||o.touches.length===0||o.touches[0].clientY-U.value<0&&Math.abs(i.scrollTop)<10&&!C.value&&!f.value&&se(!0)},$e=()=>G(this,null,function*(){if(u.isAuthorized)if(p.isInitialized)p.channels.length;else try{yield p.init()}catch(o){}}),ge=o=>{};tl(()=>G(this,null,function*(){yield $e(),_(),yield be(),ba&&document.addEventListener("click",ge)})),wa(()=>p.isSendRedPacketinProgress,(o,i)=>G(this,null,function*(){if(!o)try{oe()}catch(t){}}),{immediate:!0,flush:"post"}),wa([()=>p.activeChannelMessages],([o])=>{o&&o.length>0&&be(()=>{setTimeout(()=>{Ie()},100)})},{immediate:!0,deep:!0}),sl(()=>{ba&&document.removeEventListener("click",ge),F.value&&F.value.disconnect(),O.value.clear()});function ie(o){const i=O.value.get(o);if(i&&g.value){const t=g.value.getBoundingClientRect(),r=i.getBoundingClientRect().top-t.top+g.value.scrollTop;g.value.scrollTo({top:r-100,behavior:"smooth"}),setTimeout(()=>{i&&(i.classList.add("message-highlight-flash"),setTimeout(()=>{i.classList.remove("message-highlight-flash")},800))},500)}}function ze(o){const i=document.getElementById(o.toString());if(i&&X.value){const t=i.offsetTop-i.clientHeight;X.value.scrollTo({top:t,behavior:"smooth"}),setTimeout(()=>{i&&(i.classList.add("message-highlight-flash"),setTimeout(()=>{i.classList.remove("message-highlight-flash")},800))},500)}}function pe(o){return G(this,null,function*(){const i=rl(),t={body:JSON.stringify(o),path:`bc1p20k3x2c4mglfxr5wa5sgtgechwstpld80kru2cg4gmm4urvuaqqsvapxu0:/protocols/${N.ShareChatMessage}`,flag:"metaid",version:"1.0.1",operation:"create",contentType:"application/json",encryption:"0",encoding:"utf-8"},r=yield ae.createPin(t,!0,!1).catch(y=>{i.close(),nl.error(y.message)});r?(i.close(),J.isShowShareSuccessModal=!0):r===null&&i.close()})}return I({scrollToIndex:ie,scrollToTimeStamp:ze,scrollToMessagesBottom:oe}),(o,i)=>{var S,h,A;const t=Me,r=xe,y=ka;return l(),c(K,null,[e(u).isAuthorized&&(e(J).isShowMessagesLoading||e(p).isInitialized===!1||e(p).activeChannelMessages.length===0&&((h=(S=e(p).activeChannel)==null?void 0:S.lastMessage)==null?void 0:h.index)>0)?(l(),c("div",vs,[x(La)])):(l(),c("div",{key:1,class:"h-full relative overflow-y-auto",ref_key:"messagesScroll",ref:X,id:"messagesScroll"},[((A=e(j))==null?void 0:A.type)==="private"&&!e(j).publicKeyStr?(l(),L(t,{key:0,title:o.$t("user_private_chat_unsupport"),type:"error","show-icon":"",closable:!1},null,8,["title"])):v("v-if",!0),v(" \u5E7F\u64AD\u804A\u5929\u5934\u90E8 - \u5728\u6D88\u606F\u5217\u8868\u6700\u4E0A\u65B9\uFF08\u7B80\u5316\u7248\u63D0\u793A\uFF09 "),v(` <div v-if="_welComePage && layout.showWelcomeDescView">
      <div class="mt-20 px-1 flex text-center  items-center justify-center flex-col">
        <div class="">
          <Icon name="welcome_icon" class="w-[140px] h-[38px]"></Icon>
        </div>
        <div class="text-2xl welcome-desc text-zinc-800 mt-3 break-all flex items-center justify-center max-w-[326px]">
         <span>
          A Decentralized Messaging App Built on Bitcoin
         </span>
        </div>
        <div class="text-xl mt-5 text-zinc-600 break-all ">
          Fully Decentralized,Immutable,Uncensorable,and Unhackable
        </div>
        <div class="flex flex-col mt-5">
          <div class="font-medium flex flex-row items-center text-lg">
            <span>{{ $t('link.metaid.group') }}</span
            ><el-icon><CaretBottom /></el-icon>
          </div>
          <a class="main-border mt-5 text-lg primary p-3" @click="toMetaIdGrop">{{
            $t('MetaID.official_group')
          }}</a>
        </div>
      </div>
    </div> `),a("div",xs,[x(os),x(ps),a("div",{class:"list-container",ref_key:"listContainer",ref:g,onScrollPassive:Ce,onWheelPassive:Te,onTouchstartPassive:Se,onTouchmovePassive:Pe},[v(" \u9876\u90E8\u52A0\u8F7D\u6307\u793A\u5668 "),ve(a("div",fs,ks,512),[[fe,$.value]]),v(" \u5217\u8868\u9879\u5C06\u88AB\u6E32\u67D3\u5230\u8FD9\u91CC "),v(" ref \u7528\u4E8E\u5728\u4EE3\u7801\u4E2D\u76F4\u63A5\u8BBF\u95EE\u8FD9\u4E2A DOM \u5143\u7D20 "),a("div",{ref_key:"listWrapper",ref:w},[v(" \u4F7F\u7528 v-for \u5FAA\u73AF\u6E32\u67D3\u5217\u8868\u9879 "),e(ue)==="group"||e(ue)==="sub-group"?(l(!0),c(K,{key:0},ye(e(p).activeChannelMessages,M=>(l(),L(dl,{key:M.txId||M.timestamp,message:M,id:M.timestamp,"data-message-index":M.index,"data-message-mockId":M.mockId||"",ref_for:!0,ref:q=>me(q,M),onQuote:q=>n("quote",q),onToBuzz:pe,onToTimeStamp:ie},null,8,["message","id","data-message-index","data-message-mockId","onQuote"]))),128)):(l(!0),c(K,{key:1},ye(e(p).activeChannelMessages,M=>(l(),L(Vt,{key:M.txId||M.timestamp,message:M,"data-message-mockId":M.mockId||"","data-message-index":M.index,ref_for:!0,ref:q=>me(q,M),onQuote:q=>n("quote",q),id:M.timestamp,onToBuzz:pe,onToTimeStamp:ie},null,8,["message","data-message-mockId","data-message-index","onQuote","id"]))),128)),x(ga,{name:"fade-scroll-button",mode:"out-in",persisted:""},{default:D(()=>[ve(a("div",{class:"scroll-to-bottom-button cursor-pointer",onClick:i[0]||(i[0]=M=>oe())},[e(W)>0?(l(),L(y,{key:0,value:e(W),class:"item",max:9999,"show-zero":!1},{default:D(()=>[a("div",hs,[x(r,{class:"text-dark-800 dark:text-white"},{default:D(()=>[x(e(_a))]),_:1})])]),_:1},8,["value"])):(l(),c("div",bs,[x(r,{class:"text-dark-800 dark:text-white"},{default:D(()=>[x(e(_a))]),_:1})]))],512),[[fe,te.value||e(W)>0]])]),_:1})],512),a("div",{class:"message-list-bottom-spacer",ref_key:"bottomSpacer",ref:R},null,512),v(" \u5E95\u90E8\u52A0\u8F7D\u6307\u793A\u5668 "),ve(a("div",ws,Ms,512),[[fe,f.value]])],544)])],512)),x(ml,{modelValue:V.value,"onUpdate:modelValue":i[1]||(i[1]=M=>V.value=M),repostTxId:Z.value,ref_key:"PublishRef",ref:ee},null,8,["modelValue","repostTxId"])],64)}}});Ia=he(Is,[["__scopeId","data-v-20e084c1"]])}));export{hl as __tla,Ia as default};
