var L=(K,Q,R)=>new Promise((N,O)=>{var G=j=>{try{V(R.next(j))}catch(W){O(W)}},H=j=>{try{V(R.throw(j))}catch(W){O(W)}},V=j=>j.done?N(j.value):Promise.resolve(j.value).then(G,H);V((R=R.apply(K,Q)).next())});import{d as E,o as s,c as u,a as t,b as i,U as Ee,t as P,dh as $t,bg as De,d3 as St,i as ce,bw as jt,j as g,h as de,cH as Mt,cx as Ve,fl as Bt,cy as te,M as A,f as At,g as ue,cG as qt,u as n,m as r,e as Kt,v as D,Z as pe,S as zt,bo as Ft,V as X,w as q,Y as ae,F as ve,f5 as ye,f6 as Rt,fK as We,fX as Le,fr as Ut,fs as Et,dr as Dt,ds as Vt,be as le,cC as Xe,fY as Wt,fZ as Lt,f_ as Xt,f$ as Ot,g0 as Qt,g1 as Nt,cb as Gt,_ as Oe,n as Ht,x as Qe,cF as Jt,fn as Ne,fE as Yt,fw as Zt,aI as ea,g2 as ta,p as aa,g3 as la,q as ra,s as sa,__tla as na}from"./index.60c95b13.js";import{S as oa,__tla as ia}from"./Sticker.24c3cd1f.js";import{j as ca,__tla as da}from"./index.7b78b19f.js";import{B as ua,H as pa,P as va,__tla as ya}from"./popover.f9105e72.js";let Ge,me,ma=Promise.all([(()=>{try{return na}catch(K){}})(),(()=>{try{return ia}catch(K){}})(),(()=>{try{return da}catch(K){}})(),(()=>{try{return ya}catch(K){}})()]).then(()=>L(void 0,null,function*(){let K,Q,R,N,O,G,H,V,j,W,ge,fe,he,xe,ke,be,we,_e,Ce,Ie,Te,Pe,$e,Se,je,Me,Be,Ae,qe,Ke;K={class:"relative h-full w-full flex items-center justify-center"},Q={class:"mt-2"},me=E({__name:"ImagePreview",props:{src:{default:""},isPrivateChat:{type:Boolean,default:!1},chatPubkeyForDecrypt:{default:""}},setup(c){const o=c,f=()=>{const d=$t(o.src,-1);window.open(d,"_blank")};return(d,v)=>{const h=De,z=St;return s(),u("div",{class:"fixed inset-0 bg-black/80 fullscreen w-screen z-[60]",onClick:v[2]||(v[2]=$=>d.$emit("close"))},[t("div",K,[t("div",{class:"text-white absolute right-[16PX] top-[16PX]",onClick:v[0]||(v[0]=$=>d.$emit("close"))},[i(h,{name:"x_circle",class:"w-10 h-10 text-dark-300 hover:text-dark-100 cursor-pointer"})]),t("div",{class:"!w-[90%] !max-h-[80%] overflow-y-auto pr-3 -mr-3 lg:!w-[480PX]",onClick:v[1]||(v[1]=Ee(()=>{},["stop"]))},[i(z,{src:c.src,class:"h-3/5 flex items-center",customClass:"w-full rounded-md object-scale-down",width:-1,isPrivateChat:c.isPrivateChat,chatPubkeyForDecrypt:c.chatPubkeyForDecrypt},null,8,["src","isPrivateChat","chatPubkeyForDecrypt"]),t("div",Q,[t("span",{class:"text-white text-sm opacity-50 lg:hover:opacity-100 lg:hover:underline lg:cursor-pointer",onClick:f},P(d.$t("Talk.Channel.view_original")),1)])])])])}}}),R={key:0,class:"bg-white dark:bg-gray-700 rounded-lg"},N={key:0,class:"quote flex flex-align-center rounded-lg"},O={class:"flex1 flex flex-align-center whitespace-nowrap"},G={class:"grow truncate"},H={key:1,class:"border-b-2 border-solid border-dark-200 dark:border-gray-600 pb-2 px-3 pt-3"},V={class:"p-2 w-50 h-50 main-border still relative"},j={class:"absolute right-0 top-0 z-10 -my-2 -mx-3 flex space-x-2.5 items-center"},W={class:""},ge={key:1,class:"w-3.5 h-3.5 bg-gray-100 dark:bg-gray-950 rounded shadow-inner shadow-gray-200 dark:shadow-gray-950"},fe=["src"],he={class:"self-stretch lg:ml-2 py-2 pl-3 flex items-center grow"},xe=["rows","placeholder"],ke={class:"flex h-full py-1 items-center shrink-0"},be={class:"p-2 w-9 h-9 transition-all lg:hover:animate-wiggle cursor-pointer"},we={class:"bg-white dark:bg-gray-700 p-2 rounded-xl shadow-lg w-60 divide-y divide-dark-200 dark:divide-gray-600"},_e=["onClick"],Ce={class:"cursor-pointer"},Ie={class:""},Te={class:"p-1 w-9 h-9 transition-all lg:hover:animate-wiggle cursor-pointer"},Pe={key:0,class:X(["lg:hidden transition-all ease-in-out duration-500"])},$e={class:"text-primary scale-110 -rotate-6"},Se={key:1,class:"bg-gray-100 dark:bg-gray-700 rounded-lg px-4 py-3 text-sm text-dark-250 dark:text-gray-500 cursor-not-allowed truncate"},je={class:"px-2 py-2"},Me={class:"text-lg text-center font-medium text-gray-900 dark:text-gray-100"},Be={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},Ae={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},qe={class:"px-2 pb-2"},Ke=E({__name:"TheInput",props:{quote:null},emits:["update:quote","toQuote","scrollToBottom"],setup(c,{emit:o}){const f=c,d=ce();jt(),g(!1);const v=g(!1),h=g(!1),z=g(!1),$=de();Mt();const p=Ve(),x=Bt(),e=te(),M=A(()=>k.value.length>0),J=At(),ft=l=>{var a,b,m;console.log("props.session",l);try{if(l.encryption=="aes"){let w=((a=l.channelId||l.groupId)==null?void 0:a.substring(0,16))||"";switch(l.chatType){case 1:case ye.msg:return Rt(l.content,w);case ye.red:return l.content;case ye.img:return`[${d.t("new_msg_img")}]`;default:return""}}else{const w=Ve(),S=l.metaId!==e.selfMetaId?(b=l==null?void 0:l.fromUserInfo)==null?void 0:b.chatPublicKey:(m=l==null?void 0:l.toUserInfo)==null?void 0:m.chatPublicKey;if(!S)return"";let C=w.getEcdh(S);try{const I=C==null?void 0:C.sharedSecret;return I?We(l.content,I):""}catch(I){return""}}}catch(w){return""}};A(()=>!(window.innerWidth<=1024)||!M.value);const re=g(null),U=g(null),Y=g(!1),Z=g(!0),ht=A(()=>U.value!==null);A(()=>e.activeChannel);const xt=l=>{var a;J.checkWebViewBridge(),J.isWebView&&Le({isNeed:!1}),(a=re.value)==null||a.click(),l()},kt=()=>{h.value=!0},se=l=>{h.value=!1,$.selectedRedPacketType=l,$.isShowRedPacketModal=!0},Fe=()=>{h.value=!1},bt=l=>{var b;J.checkWebViewBridge(),J.isWebView&&Le({isNeed:!0});const a=(b=l.target.files)==null?void 0:b[0];if(a){if(!Ut(a)){x.$patch({error:{type:"image_only",message:"image_only",timestamp:Date.now()}});return}if(Et(a)){x.$patch({error:{type:"image_too_large",message:"image_too_large",timestamp:Date.now()}});return}U.value=a}},Re=()=>{U.value=null,re.value.value=""},ne=A(()=>U.value?URL.createObjectURL(U.value):""),wt=()=>L(this,null,function*(){var w,S,C,I,y,B;o("scrollToBottom");let l=U.value;Z.value&&(l=yield Dt(U.value)),console.log("size",l.size/1024,"KB");const a=[yield Vt(l)];if(((w=e.activeChannel)==null?void 0:w.type)=="private"){if(!((S=e.activeChannel)!=null&&S.publicKeyStr))return le.error(`${d.t("get_ecdh_pubey_error")}`);let T=p.getEcdh((C=e.activeChannel)==null?void 0:C.publicKeyStr);T||(T=yield Xe(e.activeChannel.publicKeyStr),p.insert(T,T==null?void 0:T.externalPubKey)),console.log("contentcontentcontent2222222",a[0].data);const ee=T==null?void 0:T.sharedSecret;a[0].data=Wt(a[0].data,ee)}const b=ne.value;Re();const m={type:Lt.Image,channelId:e.activeChannelId,groupId:((I=e.activeChannel)==null?void 0:I.type)=="private"?"":e.activeChannelId||"",userName:(y=_t.last)==null?void 0:y.name,attachments:a,content:"",originalFileUrl:b,channelType:(B=e.activeChannel)==null?void 0:B.type,reply:f.quote};o("update:quote",void 0),yield Xt(m)}),k=g(""),_t=ue();qt();const F=g(!1),Ct=g(null),oe=g(!1),It=()=>{oe.value=!0},Tt=()=>{oe.value=!1},Pt=l=>{l.key==="Enter"&&!l.shiftKey&&!oe.value&&(l.preventDefault(),Ue())},ie=A(()=>{if(F.value)return 1;const l=k.value.split(`
`).reduce((a,b)=>a+1,0);return Math.min(Math.max(l,1),10)}),Ue=l=>L(this,null,function*(){var b,m,w,S,C,I;if(F.value=!0,k.value=k.value.trim(),!Ot(k.value)){F.value=!1;return}if(z.value){F.value=!1;return}console.log("activeChannel type:",(b=e.activeChannel)==null?void 0:b.type),o("scrollToBottom");let a="";if(((m=e.activeChannel)==null?void 0:m.type)==="group"||((w=e.activeChannel)==null?void 0:w.type)==="sub-group")a=Qt(k.value,e.activeChannel.id.substring(0,16)),console.log("sub-group chat content:",a,e.activeChannel.id.substring(0,16));else{if(!((S=e.activeChannel)!=null&&S.publicKeyStr))return F.value=!1,le.error(`${d.t("get_ecdh_pubey_error")}`);let y=p.getEcdh((C=e.activeChannel)==null?void 0:C.publicKeyStr);y||(y=yield Xe(e.activeChannel.publicKeyStr),y&&p.insert(y,y==null?void 0:y.externalPubKey));const B=y==null?void 0:y.sharedSecret;if(!B)return F.value=!1,le.error("Failed to generate shared secret");console.log(k.value,B),a=Nt(k.value,B),console.log("ecdhDecrypt",We(a,B))}if(k.value="",console.log("simpleTalk.activeChannel.id",(I=e.activeChannel)==null?void 0:I.id),!e.activeChannel){console.error("No active channel"),F.value=!1;return}try{yield e.sendMessage(e.activeChannel.id,a,0,f.quote),f.quote&&o("update:quote",void 0),console.log("Message sent successfully via simpleTalk")}catch(y){console.error("Failed to send message via simpleTalk:",y)}F.value=!1});return(l,a)=>{var w,S,C,I,y,B,T,ee;const b=Gt,m=De;return s(),u(ve,null,[((w=n(e).activeChannel)==null?void 0:w.type)==="private"||((S=n(e).activeChannel)==null?void 0:S.type)==="group"||((C=n(e).activeChannel)==null?void 0:C.type)==="sub-group"?(s(),u("div",R,[r(" \u56DE\u590D/\u5F15\u7528 "),c.quote?(s(),u("div",N,[t("div",O,[Kt(P(l.$t("Talk.Quote.tips"))+" ",1),t("a",{onClick:a[0]||(a[0]=_=>o("toQuote")),class:"user"},[i(b,{name:c.quote.userInfo?c.quote.userInfo.name:c.quote.fromUserInfo.name,"meta-name":"","no-tag":!0},null,8,["name"])]),t("span",G,":"+P(ft(c.quote)),1)]),i(m,{name:"x_circle",class:"close",onClick:a[1]||(a[1]=_=>o("update:quote",void 0))})])):r("v-if",!0),r(" \u4E0A\u4F20\u56FE\u9884\u89C8 "),n(ht)?(s(),u("div",H,[t("div",V,[t("div",j,[r(" \u538B\u7F29\u6309\u94AE "),t("div",{class:"main-border small bg-white dark:bg-gray-700 p-1.5 cursor-pointer !rounded-lg text-xs flex items-center justify-center gap-x-1",onClick:a[2]||(a[2]=_=>Z.value=!Z.value)},[t("div",W,P(l.$t("Talk.Input.compress")),1),Z.value?(s(),D(m,{key:0,name:"check_bold",class:"w-2.5 h-2.5 inline bg-primary rounded p-0.5 box-content"})):(s(),u("div",ge))]),r(" \u5220\u9664\u6309\u94AE "),t("div",{class:"main-border small bg-white dark:bg-gray-700 p-1.5 cursor-pointer !rounded-lg",onClick:Re},[i(m,{name:"x_mark",class:"w-4 h-4 text-dark-800 dark:text-gray-100"})]),r(" \u53D1\u9001\u6309\u94AE "),t("div",{class:"main-border primary p-1.5 cursor-pointer small !rounded-lg",onClick:wt},[i(m,{name:"send",class:"w-4 h-4 text-dark-800 -rotate-6"})])]),t("img",{src:n(ne),class:"w-full h-full object-scale-down cursor-zoom-in",onClick:a[3]||(a[3]=_=>Y.value=!0)},null,8,fe)]),Y.value?(s(),D(pe,{key:0,to:"body"},[Y.value?(s(),D(me,{key:0,src:n(ne),onClose:a[4]||(a[4]=_=>Y.value=!1)},null,8,["src"])):r("v-if",!0)])):r("v-if",!0)])):r("v-if",!0),t("div",{class:X([n(ie)>1?"items-start":"items-center","flex h-fit"])},[r(` <Popover class="relative flex items-center" v-slot="{ open }">
        <PopoverButton
          as="button"
          class="w-14 flex items-center py-2 justify-center text-dark-800 dark:text-gray-100 outline-0"
        >
          <div
            class="bg-primary w-8 h-8 flex items-center justify-center rounded-full cursor-pointer"
          >
            <Icon
              name="plus_2"
              :class="[open && 'rotate-45', 'w-3 h-3 text-dark-800 transition duration-200']"
            />
          </div>
        </PopoverButton>

        <transition
          enter-active-class="transition duration-200 ease-out"
          enter-from-class="opacity-0"
          enter-to-class="opacity-100"
          leave-active-class="transition duration-150 ease-in"
          leave-from-class="opacity-100"
          leave-to-class="opacity-0"
        >
          <PopoverPanel
            class="absolute z-10 transform top-[-16PX] left-0 -translate-y-full"
            v-slot="{ close }"
          >
            <div
              class="bg-white dark:bg-gray-700 dark:text-gray-100 py-2 px-4 rounded-xl flex flex-col w-max justify-stretch divide-dark-100 dark:divide-gray-800 divide-y divide-solid"
            >
              <button
                class="flex py-4 outline-none hover:bg-gray-100 dark:hover:bg-gray-800 px-4 -mx-4 space-x-3 items-center"
                type="button"
                v-for="command in moreCommands()"
                :key="command.titleKey"
                @click="command.action(close)"
              >
                <Icon
                  :name="command.icon"
                  class="w-6 h-6 text-dark-800 rounded-full bg-primary box-content p-1.5 shrink-0"
                />

                <div class="flex flex-col justify-start items-start">
                  <h4 class="shrink-0 text-sm">{{ $t(command.titleKey) }}</h4>
                  <p class="text-xs text-dark-300 dark:text-gray-400">
                    {{ $t(command.descriptionKey) }}
                  </p>
                </div>
              </button>
            </div>
          </PopoverPanel>
        </transition>
      </Popover> `),r(` <button
        class="w-14 flex items-center py-2 justify-center text-dark-800 dark:text-gray-100"
        type="button"
        @click="showMoreCommandsBox = true"
      >
        <div
          class="bg-primary w-8 h-8 flex items-center justify-center rounded-full cursor-pointer"
        >
          <Icon name="plus_2" class="w-3 h-3 text-dark-800 dark:text-gray-100" />
        </div>
      </button> `),t("div",he,[zt(t("textarea",{class:X(["w-full !outline-none placeholder:text-dark-250 placeholder:dark:text-gray-400 placeholder:text-sm placeholder:truncate text-dark-800 dark:text-gray-100 text-base caret-gray-600 dark:caret-gray-400 resize-none !h-fit text-base rounded-md transition-all duration-150 delay-100",n(ie)>1?"bg-gray-100 dark:bg-gray-800 p-1 -m-1":"bg-inherit"]),rows:n(ie),ref_key:"theTextBox",ref:Ct,placeholder:l.$t("Talk.Channel.message_to",{channel:(((I=n(e).activeChannel)==null?void 0:I.type)==="group"||((y=n(e).activeChannel)==null?void 0:y.type)==="sub-group"?"#":"@")+(((B=n(e).activeChannel)==null?void 0:B.name)||"")}),"onUpdate:modelValue":a[5]||(a[5]=_=>k.value=_),onKeydown:Pt,onCompositionstart:It,onCompositionend:Tt},null,42,xe),[[Ft,k.value]])]),(s(),D(pe,{to:"body"},[t("input",{type:"file",id:"imageUploader",ref_key:"imageUploader",ref:re,accept:"image/*",onChange:bt,class:"hidden"},null,544)])),r(" \u53F3\u4FA7\u6309\u94AE\u7FA4 "),t("div",ke,[t("div",{class:X([n(M)?"hidden lg:flex":"flex","items-center px-1 mr-2"])},[(((T=n(e).activeChannel)==null?void 0:T.type)==="group"||((ee=n(e).activeChannel)==null?void 0:ee.type)==="sub-group")&&!c.quote?(s(),u("div",{key:0,class:"p-2 w-9 h-9 transition-all lg:hover:animate-wiggle cursor-pointer",onClick:kt},[i(m,{name:"red_envelope",class:"w-full h-full text-dark-800 dark:text-gray-100"})])):r("v-if",!0),i(n(va),{class:"relative flex items-center"},{default:q(()=>[i(n(ua),{as:"div"},{default:q(()=>[t("div",be,[i(m,{name:"photo_3",class:"w-full h-full text-dark-800 dark:text-gray-100"})])]),_:1}),i(ae,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[i(n(pa),{class:"absolute z-10 transform top-[-16PX] right-0 -translate-y-full"},{default:q(({close:_})=>[t("div",we,[t("div",{class:"mx-2 py-4 flex items-center space-x-2 text-dark-800 dark:text-gray-100 rounded-sm lg:cursor-pointer lg:hover:underline cursor-pointer",onClick:ga=>xt(_)},[t("div",Ce,[i(m,{name:"photo",class:"w-5 h-5 rounded-full bg-primary p-2 box-content"})]),t("div",Ie,P(l.$t("Talk.Channel.upload_image")),1)],8,_e),r(` <div
                    class="mx-2 py-4 flex items-center space-x-2 text-dark-800 dark:text-gray-100 rounded-sm lg:cursor-pointer lg:hover:underline cursor-pointer"
                  >
                    <div class=" ">
                      <Icon name="link" class="w-5 h-5 rounded-full bg-primary p-2 box-content" />
                    </div>
                    <div class="">
                      {{ $t('Talk.Channel.use_onchain_image') }}
                    </div>
                  </div> `)])]),_:1})]),_:1})]),_:1}),i(n(ca),{placement:"bottom-start",width:"300px",trigger:"click"},{reference:q(()=>[t("div",Te,[i(m,{name:"face_smile",class:X(["w-full h-full text-dark-800 dark:text-gray-100 transition-all ease-in-out duration-300",{"text-primary -rotate-6 scale-110":v.value}])},null,8,["class"])])]),default:q(()=>[i(oa,{onInput:a[6]||(a[6]=_=>k.value=k.value+_.value)})]),_:1})],2),r(" \u53D1\u9001\u6309\u94AE "),i(ae,{"enter-active-class":"transition duration-150 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100"},{default:q(()=>[n(M)?(s(),u("div",Pe,[t("div",{class:"py-2 px-3",onClick:Ue},[r(` <div
              class="transition-all ease-in-out duration-500"
              :class="[
                hasInput ? 'text-primary scale-110 -rotate-6' : 'text-dark-250 dark:text-gray-400',
              ]"
            >
              <Icon name="send" class="w-5 h-5" />
            </div> `),t("div",$e,[i(m,{name:"send",class:"w-5 h-5"})])])])):r("v-if",!0)]),_:1})])],2)])):(s(),u("div",Se,P(l.$t("Talk.Input.dont_have_permission")),1)),r(" Apple Style Action Sheet "),(s(),D(pe,{to:"body"},[i(ae,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[h.value?(s(),u("div",{key:0,class:"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50 md:items-center",onClick:Fe},[i(ae,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform translate-y-full opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform translate-y-full opacity-0"},{default:q(()=>[h.value?(s(),u("div",{key:0,class:"w-full max-w-xs sm:max-w-xs md:w-96 bg-white dark:bg-gray-800 rounded-t-xl shadow-xl transform md:rounded-xl",onClick:a[10]||(a[10]=Ee(()=>{},["stop"]))},[r(" Options "),t("div",je,[r(" MVC Red Packet "),t("button",{onClick:a[7]||(a[7]=_=>se("mvc")),class:"w-full flex items-center px-4 py-4 justify-center hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors duration-200 active:scale-95"},[t("h4",Me," SPACE "+P(l.$t("Talk.Modals.red_packet")),1)]),r(" BTC Red Packet "),t("button",{onClick:a[8]||(a[8]=_=>se("btc")),class:"w-full flex text-center items-center px-4 py-4 justify-center hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors duration-200 active:scale-95"},[t("h4",Be," BTC "+P(l.$t("Talk.Modals.red_packet")),1)]),r(" Token Red Packet "),t("button",{onClick:a[9]||(a[9]=_=>se("token")),class:"w-full flex text-center items-center px-4 py-4 justify-center hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors duration-200 active:scale-95"},[t("h4",Ae," Token "+P(l.$t("Talk.Modals.red_packet")),1)])]),r(" Cancel Button "),t("div",qe,[t("button",{onClick:Fe,class:"w-full py-4 text-center text-gray-600 dark:text-gray-400 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 rounded-xl transition-colors duration-200 active:scale-95"},P(l.$t("cancel")),1)])])):r("v-if",!0)]),_:1})])):r("v-if",!0)]),_:1})]))],64)}}});const He=Oe(Ke,[["__scopeId","data-v-f0daf5f3"]]),Je={class:"bg-white flex items-center justify-center dark:bg-gray-700 w-full py-[20px]"},Ye={class:"font-lg text-[#FC4F60]"},Ze=E({__name:"MuteInput",setup(c){return ce(),(o,f)=>(s(),u("div",Je,[t("span",Ye,P(o.$t("Mute")),1)]))}}),et={class:"h-6"},tt=E({__name:"TheErrorBox",setup(c){const o=g(!1);return(f,d)=>(s(),u("div",et,[t("div",{class:X(["font-medium text-xs pt-0.5 transition-all duration-300 ease-out",[o.value?"text-rose-500":"invisible"]])},[r(" {{ $t('Talk.Errors.' + talkStore.error.type, $t('Talk.Errors.default')) }} ")],2)]))}}),at={class:"font-lg text-[#FC4F60]"},lt=E({__name:"JoinInput",setup(c){const o=de(),f=ue(),d=Ht();Qe();const v=ce(),{openConnectionModal:h,closeConnectionModal:z,setMissingWallet:$}=Jt(),p=()=>{o[Ne.isShowChannelAcceptInviteModal]=!1,h()},x=()=>L(this,null,function*(){try{if(!f.isAuthorized)return p();const e=te();o[Ne.isShowChannelAcceptInviteModal]=!1,o.isShowLoading=!0;const M=yield Yt(e.activeChannelId);if(o.isShowLoading=!1,M.status==="failed"){d.push("/");return}yield Zt(1e3),e.isInitialized||(yield e.init()),e.convertTemporaryToRegular(e.activeChannelId),yield e.syncFromServer()}catch(e){o.isShowLoading=!1,le.error(`${e.toString()}! ${v.t("retry_join")}`)}});return(e,M)=>(s(),u("div",{class:"bg-white flex items-center justify-center dark:bg-gray-700 w-full py-[20px]",onClick:x},[t("span",at,P(e.$t("Join")),1)]))}}),rt={class:"h-full pb-17.5 lg:pb-20"},st={class:"fixed bottom-0 left-0 right-0 px-4 lg:absolute"},nt={key:0,class:"fixed bottom-0 left-0 right-0 lg:absolute"},ot={key:1,class:"fixed bottom-0 left-0 right-0 lg:absolute"},it=E({__name:"ChannelContent",setup(c){const o=ea({val:void 0}),f=ta({loader:()=>la(()=>import("./MessageList.2e41a908.js").then(p=>L(this,null,function*(){return yield p.__tla,p})),["MessageList.2e41a908.js","index.60c95b13.js","index.eb3983b0.css","Publish.870a3d57.js","modals.40b81ca4.js","index.7b78b19f.js","modals.1cd2d636.css","Card.bc476c2b.css","Sticker.24c3cd1f.js","Sticker.91d28555.css","Publish.2abfc8fa.css","sub-channel.b3a9a7fc.js","popover.f9105e72.js","MessageList.7ee63a23.css"])}),d=g(),v=te();function h(){d.value.scrollToTimeStamp(o.val.timestamp)}function z(){var p;console.log("scrollToBottom"),(p=d.value)==null||p.scrollToMessagesBottom()}const $=A(()=>{var p,x,e;if(((p=v.activeChannel)==null?void 0:p.type)==="sub-group"){const M=v.getCurrentUserRoleInGroup(v.activeChannel.parentGroupId);return M.isAdmin||M.isCreator||M.isWhitelist?"allowed":"forbidden"}else return((x=v.activeChannel)==null?void 0:x.type)==="group"?v.activeChannel.isTemporary?"join":"allowed":(e=v.activeChannel)!=null&&e.publicKeyStr?"allowed":"forbidden"});return aa("Reply",o),(p,x)=>(s(),u(ve,null,[t("div",rt,[i(n(f),{onQuote:x[0]||(x[0]=e=>o.val=e),ref_key:"MessageListRef",ref:d},null,512)]),t("div",st,[n($)==="allowed"?(s(),D(He,{key:0,quote:o.val,"onUpdate:quote":x[1]||(x[1]=e=>o.val=e),onToQuote:h,onScrollToBottom:z},null,8,["quote"])):r("v-if",!0),i(tt)]),n($)==="forbidden"?(s(),u("div",nt,[i(Ze)])):r("v-if",!0),n($)==="join"?(s(),u("div",ot,[i(lt)])):r("v-if",!0)],64))}}),ct="/chat/welcome.864ee172.png",dt=c=>(ra("data-v-2ebbbabf"),c=c(),sa(),c),ut={key:0},pt={key:0,class:"mt-20 px-1 flex text-center items-center justify-center flex-col"},vt={class:""},yt=["src"],mt=dt(()=>t("div",{class:"text-2xl welcome-desc text-[#AAAAAA] mt-3 flex items-center justify-center"},[t("span",null," A Decentralized Messaging App Built on Bitcoin ")],-1)),gt=E({__name:"ChannelBody",setup(c){de();const o=ue(),f=Qe(),d=te(),{communityId:v,channelId:h}=f.params,z=A(()=>h=="welcome"),$=A(()=>{if(!o.isAuthorized)return!0;if(d.isInitialized){const p=d.activeChannelMessages.length>0;return!d.activeChannel||!p}return!1});return(p,x)=>(s(),u(ve,null,[r(` <ChannelWelcome v-if="talk.isActiveChannelTheVoid" />
  <ChannelSettings v-else-if="talk.isActiveChannelTheVoid" /> `),n(z)?(s(),u("div",ut,[n($)?(s(),u("div",pt,[t("div",vt,[r(' <Icon name="welcome_icon" class="w-[140px] h-[38px]"></Icon> '),t("img",{src:n(ct),class:"w-[140px] h-[38px]",alt:""},null,8,yt)]),mt])):r("v-if",!0)])):(s(),D(it,{key:1}))],2112))}});let ze;ze=Oe(gt,[["__scopeId","data-v-2ebbbabf"]]),Ge=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}))}));export{Ge as C,me as _,ma as __tla};
