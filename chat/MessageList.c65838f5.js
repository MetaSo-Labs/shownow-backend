var _s=Object.defineProperty,Ms=Object.defineProperties;var Cs=Object.getOwnPropertyDescriptors;var ia=Object.getOwnPropertySymbols;var Is=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable;var ca=(I,z,$)=>z in I?_s(I,z,{enumerable:!0,configurable:!0,writable:!0,value:$}):I[z]=$,da=(I,z)=>{for(var $ in z||(z={}))Is.call(z,$)&&ca(I,$,z[$]);if(ia)for(var $ of ia(z))Ts.call(z,$)&&ca(I,$,z[$]);return I},ma=(I,z)=>Ms(I,Cs(z));var Q=(I,z,$)=>new Promise((Me,ce)=>{var Ce=G=>{try{le($.next(G))}catch(re){ce(re)}},Ie=G=>{try{le($.throw(G))}catch(re){ce(re)}},le=G=>G.done?Me(G.value):Promise.resolve(G.value).then(Ce,Ie);le(($=$.apply(I,z)).next())});import{C as Ss,f$ as Ps,g0 as ua,d as O,aG as $s,N as zs,j as M,M as u,o as l,v as B,w as D,S as fe,a,V as h,u as e,I as ye,y as Bs,m as v,c,W as ga,e as pa,t as d,F as Y,b as x,X as he,Y as va,R as Ns,g1 as Ls,$ as Fs,aN as ke,a2 as As,i as xa,g as fa,cy as oe,di as Us,df as ie,dl as Xs,dc as A,bf as L,r as js,T as qs,dg as be,dj as Es,Z as Rs,bh as Hs,cb as Ds,bi as ya,d4 as Gs,p as Be,n as Ne,_ as we,fE as Le,fF as Qs,fD as ha,eP as Vs,h as Os,q as Ws,bw as Js,g2 as Ys,x as Ks,eN as Zs,k as el,aa as _e,cI as ka,a5 as al,aJ as tl,g3 as ba,fr as sl,bJ as ll,bg as rl,__tla as nl}from"./index.6023e910.js";import{_ as wa,M as ol,N as il,a as cl,P as dl,__tla as ml}from"./Publish.96ccb39b.js";import{_ as ul,__tla as gl}from"./modals.4c236e75.js";import{_ as pl,__tla as vl}from"./ChannelBody.4221a80a.js";import{__tla as xl}from"./Sticker.d24f5d55.js";import{__tla as fl}from"./index.244a603e.js";import{__tla as yl}from"./popover.b7fbaa30.js";let _a,hl=Promise.all([(()=>{try{return nl}catch(I){}})(),(()=>{try{return ml}catch(I){}})(),(()=>{try{return gl}catch(I){}})(),(()=>{try{return vl}catch(I){}})(),(()=>{try{return xl}catch(I){}})(),(()=>{try{return fl}catch(I){}})(),(()=>{try{return yl}catch(I){}})()]).then(()=>Q(void 0,null,function*(){const I=["light","dark"],z=Ss({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Ps(ua),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:I,default:"light"}}),$={close:s=>s instanceof MouseEvent},Me=O({name:"ElAlert"}),ce=O(ma(da({},Me),{props:z,emits:$,setup(s,{emit:C}){const n=s,{Close:S}=Ls,N=$s(),f=zs("alert"),w=M(!0),g=u(()=>ua[n.type]),X=u(()=>[f.e("icon"),{[f.is("big")]:!!n.description||!!N.default}]),T=u(()=>({[f.is("bold")]:n.description||N.default})),U=m=>{w.value=!1,C("close",m)};return(m,p)=>(l(),B(va,{name:e(f).b("fade"),persisted:""},{default:D(()=>[fe(a("div",{class:h([e(f).b(),e(f).m(m.type),e(f).is("center",m.center),e(f).is(m.effect)]),role:"alert"},[m.showIcon&&e(g)?(l(),B(e(ye),{key:0,class:h(e(X))},{default:D(()=>[(l(),B(Bs(e(g))))]),_:1},8,["class"])):v("v-if",!0),a("div",{class:h(e(f).e("content"))},[m.title||m.$slots.title?(l(),c("span",{key:0,class:h([e(f).e("title"),e(T)])},[ga(m.$slots,"title",{},()=>[pa(d(m.title),1)])],2)):v("v-if",!0),m.$slots.default||m.description?(l(),c("p",{key:1,class:h(e(f).e("description"))},[ga(m.$slots,"default",{},()=>[pa(d(m.description),1)])],2)):v("v-if",!0),m.closable?(l(),c(Y,{key:2},[m.closeText?(l(),c("div",{key:0,class:h([e(f).e("close-btn"),e(f).is("customed")]),onClick:U},d(m.closeText),3)):(l(),B(e(ye),{key:1,class:h(e(f).e("close-btn")),onClick:U},{default:D(()=>[x(e(S))]),_:1},8,["class"]))],64)):v("v-if",!0)],2)],2),[[he,w.value]])]),_:3},8,["name"]))}}));var Ce=Ns(ce,[["__file","/home/runner/work/element-plus/element-plus/packages/components/alert/src/alert.vue"]]);const Ie=Fs(Ce),le={class:"animate-pulse flex space-x-4 w-full py-4"},G=a("div",{class:"h-0 w-1/5 w-2/5 w-3/5 w-4/5 w-5/5 hidden"},null,-1),re=a("div",{class:"rounded-3xl bg-gray-300 dark:bg-gray-600 h-13.5 w-13.5"},null,-1),Ma={class:"flex-1 space-y-4 py-1"},Ca=a("div",{class:"h-2.5 bg-gray-300 dark:bg-gray-600 rounded w-1/4 max-w-[200PX]"},null,-1),Ia={class:"space-y-3"},Ta=a("div",{class:"grid grid-cols-4 gap-4"},[a("div",{class:"h-2.5 bg-gray-200 dark:bg-gray-700 rounded col-span-2"})],-1),Sa=a("div",{class:"h-2.5 bg-gray-300 dark:bg-gray-600 rounded w-1/4"},null,-1),Pa=O({__name:"LoadingItem",setup(s){const C=u(()=>`w-${Math.floor(Math.random()*4)+1}/5`);return(n,S)=>(l(),c("div",le,[G,re,a("div",Ma,[Ca,a("div",Ia,[Ta,Sa,a("div",{class:h(["h-2.5 bg-gray-200 dark:bg-gray-700 rounded",e(C)])},null,2)])])]))}}),$a={class:"overflow-x-hidden overflow-y-hidden py-4 space-y-4 px-4"},za=O({__name:"LoadingList",props:{itemCount:{type:Number,default:6}},setup(s){const C=s,n=M([]);for(let S=1;S<=C.itemCount;S++)n.value.push(S);return(S,N)=>(l(),c("div",$a,[(l(!0),c(Y,null,ke(n.value,f=>(l(),B(Pa))),256))]))}}),Ba="/chat/red-envelope.f2e185e2.svg",Na=s=>(Be("data-v-52d69d4e"),s=s(),Ne(),s),La={class:"flex"},Fa={key:0,class:"w-full"},Aa={key:1,class:"my-1.5 flex"},Ua={key:2,class:"my-1.5 flex"},Xa={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},ja={class:"rounded-xl p-4 flex space-x-4.5 bg-white dark:bg-gray-700 items-center rounded-tl border border-solid border-blue-400"},qa={class:"flex flex-col space-y-1.5"},Ea={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},Ra={class:"text-dark-400 dark:text-gray-200 text-xs"},Ha={class:"flex py-2.5 items-center space-x-1.5 px-4"},Da={class:"text-white text-xs"},Ga={key:3,class:"my-1.5 flex"},Qa={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},Va={class:"rounded-xl p-4 flex space-x-4.5 bg-white dark:bg-gray-700 items-center rounded-tl border border-solid border-blue-400"},Oa={class:"flex flex-col space-y-1"},Wa={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},Ja={key:0,class:"text-dark-400 dark:text-gray-200 text-xs"},Ya={class:"flex py-2.5 items-center space-x-1.5 px-4"},Ka={class:"text-white text-xs"},Za={key:4,class:"my-1.5 flex flex-col items-start"},et={class:"max-w-full min-w-[240PX] md:w-[300PX] shadow rounded-xl rounded-tl bg-blue-400"},at={class:"flex items-center gap-x-4.5 mb-3"},tt={class:"flex flex-col space-y-1"},st={class:"text-dark-800 dark:text-gray-100 text-base font-medium capitalize max-w-[160PX] truncate"},lt={key:0,class:"text-dark-400 dark:text-gray-200 text-xs"},rt={class:"pt-3 flex justify-between items-center"},nt={class:"text-xs text-dark-300 dark:text-gray-400"},ot={class:"text-sm"},it={class:"flex py-2.5 items-center space-x-1.5 px-4"},ct={class:"text-white text-xs"},dt={class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},mt={key:5,class:"my-1.5 flex flex-col items-start"},ut={key:0,class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},gt={key:6,class:"my-1.5 flex flex-col items-start"},pt={key:0,class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 break-all text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},vt={key:7,class:"my-1.5 flex flex-col items-start"},xt={key:8,class:"my-1.5 flex flex-col items-start"},ft={class:"mt-1.5 bg-dark-800/5 dark:bg-gray-800 break-all text-sm text-dark-400 dark:text-gray-200 rounded-xl px-3 py-2"},yt=["title"],ht={key:10,class:"text-xs text-dark-400 dark:text-gray-200 my-0.5 capitalize"},kt={class:"max-w-full md:max-w-[50%] lg:max-w-[400px] shadow-lg rounded-xl cursor-pointer origin-top-left hover:shadow-xl hover:scale-105 transition-all duration-300"},bt={class:"rounded-xl bg-red-400 p-6 flex space-x-2"},wt=["src"],_t={class:""},Mt={class:"text-white text-lg font-medium capitalize"},Ct={class:"text-red-50 text-xs mt-0.5"},It=Na(()=>a("div",{class:"py-2 px-6 text-dark-400 dark:text-gray-200 text-xs"},"Show\u7EA2\u5305",-1)),Tt={class:"p-4 space-y-3"},St={class:"flex items-center space-x-3"},Pt={class:""},$t={class:"flex-1 min-w-0"},zt={class:"text-dark-800 dark:text-gray-100 font-medium text-base truncate max-w-[200px]"},Bt={class:"text-dark-400 dark:text-gray-400 text-sm"},Nt={class:"flex gap-4 items-center"},Lt={class:"text-dark-400 dark:text-gray-400 text-xs mt-1 truncate max-w-[150px]"},Ft={key:0,class:"text-dark-400 dark:text-gray-400 text-xs mt-1"},At={class:"pt-2 border-t border-gray-200 dark:border-gray-600"},Ut={class:"main-border bg-primary hover:bg-primary-dark text-black text-center py-2 px-4 rounded-lg transition-colors duration-200 font-medium"},Xt=["innerHTML"],jt={class:"text-xxs text-dark-300 dark:text-gray-400 mt-1 underline"},qt=["innerHTML"],Et={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-700 inline-block opacity-50"},Rt=["title"],Ht={key:0,class:"text-[#fc457b] flex-1 font-sm mr-2"},Dt=O({__name:"MessageItemForSession",props:{message:null},emits:["quote","toBuzz","to-time-stamp"],setup(s,{emit:C}){const n=s,S=As("Reply"),N=xa(),f=M(!1),w=M(null),g=fa(),X=oe(),T=u(()=>X.activeChannel);Us();const U=M("hidden"),m=M("");u(()=>{var t,r,y;return n.message.from===((t=g.user)==null?void 0:t.metaId)?(r=g.user)==null?void 0:r.name:(y=T.value)==null?void 0:y.name});const p=u(()=>n.message.chain);u(()=>{var t,r,y;return n.message.from===((t=g.user)==null?void 0:t.metaId)?(r=g.user)==null?void 0:r.metaName:(y=T.value)==null?void 0:y.metaName});const W=()=>{f.value=!0},V=u(()=>N.t("Talk.Messages.resend")),K=u(()=>{const t=ie(n.message.content,n.message.encryption,n.message.protocol,n.message.isMock,!0),r=/\/channels\/public\/([a-f0-9]+)/i,y=r.test(t);if(y&&!w.value){const P=t==null?void 0:t.match(r);if(P){const k=P[1];Z(k+"i0")}}return y}),Z=t=>Q(this,null,function*(){try{const r=yield Xs(t);w.value=r}catch(r){}}),ee=()=>{const t=j.value;t.fullUrl&&window.open(t.fullUrl,"_self")},j=u(()=>{var P,k,F,b,E;const t=ie(n.message.content,n.message.encryption,n.message.protocol,n.message.isMock,!0),r=/\/channels\/public\/([a-f0-9]+)/i,y=t==null?void 0:t.match(r);return y?{pinId:y[1],groupName:(P=w.value)==null?void 0:P.roomName,groupAvatar:((k=w.value)==null?void 0:k.roomIcon)||"",memberCount:((F=w.value)==null?void 0:F.userCount)||0,fullUrl:t,creator:((E=(b=w.value)==null?void 0:b.createUserInfo)==null?void 0:E.name)||""}:{pinId:"",groupName:"Group Chat",groupAvatar:"",memberCount:0,creator:"",fullUrl:t}}),ae=()=>Q(this,null,function*(){}),H=u(()=>X.activeChannel.publicKeyStr),J=u(()=>{var t,r;if(n.message.isMock)return n.message.content;if(n.message.encryption!=="1")return((t=n.message.data)==null?void 0:t.attachment)||((r=n.message)==null?void 0:r.content)}),q=t=>{if(typeof t>"u")return"";const r=/<\/?.+?>/gi,y=/document\.cookie/gi,P=/(http|https):\/\//gi,k=/(f|ht){1}(tp|tps):\/\/([\w-]+\S)+[\w-]+([\w-?%#&=]*)?(\/[\w- ./?%#&=]*)?/g;return r.test(t)?"\u65E0\u6548\u8F93\u5165,\u522B\u800D\u82B1\u6837!":y.test(t)?"\u65E0\u6548\u8F93\u5165,\u4F60\u60F3\u5E72\u561B!":(t=t.replace(k,function(F){return P.test(t)?`<a href=${F} target="_blank" style="text-decoration: underline;cursor: pointer;" class="url"> ${F} </a>`:`<a onClick="window.open('http://${t}','_blank')" style="text-decoration: underline;cursor: pointer;" target="_blank">${t}</a>`}),t=t.replace(/\\n/g,`
`),t.replace(/\n/g,"<br />"))},de=u(()=>{var P;const t=n.message.content;if(!t)return"";if(n.message.metaId===((P=n.message.data)==null?void 0:P.redEnvelopeMetaId))return N.t("Talk.Channel.receive_own_red_envelope");const[r,y]=t.split("|-|");return N.t("Talk.Channel.receive_red_envelope",{sender:y})}),me=u(()=>{var t;return((t=n.message.data)==null?void 0:t.content)||N.t("Talk.Channel.default_red_envelope_message")}),_=u(()=>{var t,r;return((t=g.last)==null?void 0:t.metaid)&&((r=g.last)==null?void 0:r.metaid)===n.message.from}),ue=u(()=>{var t,r,y;return n.message.from===((t=g.last)==null?void 0:t.metaid)?(r=g.last)==null?void 0:r.avatar:(y=T.value)==null?void 0:y.avatar}),te=u(()=>{var t,r,y,P;if((r=(t=n.message.data)==null?void 0:t.sellUtxo)!=null&&r.price){let k=(((P=(y=n.message.data)==null?void 0:y.sellUtxo)==null?void 0:P.price)/1e8).toFixed(8);return k=k.replace(/0+$/,""),k=k+" SPACE",k}return"-"}),se=u(()=>A(n.message.protocol,L.SimpleEmojiGroupChat)),ge=u(()=>A(n.message.protocol,L.SimpleFileMsg)),Te=u(()=>A(n.message.protocol,L.SimpleGroupLuckyBag)),Se=u(()=>A(n.message.protocol,L.OpenRedenvelope)),Pe=u(()=>A(n.message.protocol,L.SimpleMsg)),$e=u(()=>A(n.message.protocol,L.PayLike)),pe=u(()=>A(n.message.protocol,L.PayFollow)),ve=u(()=>A(n.message.protocol,L.SimpleRePost)),ne=u(()=>A(n.message.nodeName,L.SimpleMicroblog)),ze=u(()=>A(n.message.protocol,L.PayComment)),xe=u(()=>A(n.message.protocol,L.FtTransfer)),o=u(()=>A(n.message.protocol,L.NftTransfer)),i=u(()=>A(n.message.protocol,L.nftBuy));return(t,r)=>{var Ae,Ue,Xe,je,qe,Ee,Re,He,De,Ge,Qe,Ve,Oe,We,Je,Ye,Ke,Ze,ea,aa,ta,sa,la,ra,na,oa;const y=Hs,P=Ds,k=ya,F=Gs,b=js("RouterLink"),E=ul;return l(),c("div",{class:h(["lg:hover:bg-gray-200 lg:dark:hover:bg-gray-950 px-4 py-1.5 relative group transition-all duration-150",{replying:((Ae=e(S).val)==null?void 0:Ae.timestamp)===s.message.timestamp}])},[v(" \u6D88\u606F\u83DC\u5355 "),e(Pe)?(l(),B(wa,{key:0,message:n.message,parsed:q(e(ie)((Ue=s.message)==null?void 0:Ue.content,(Xe=s.message)==null?void 0:Xe.encryption,(je=s.message)==null?void 0:je.protocol,(qe=s.message)==null?void 0:qe.isMock,!0)),translateStatus:U.value,"onUpdate:translateStatus":r[0]||(r[0]=R=>U.value=R),translatedContent:m.value,"onUpdate:translatedContent":r[1]||(r[1]=R=>m.value=R),onQuote:r[2]||(r[2]=R=>C("quote",R)),onToBuzz:r[3]||(r[3]=R=>C("toBuzz",R)),isMyMessage:e(_)},null,8,["message","parsed","translateStatus","translatedContent","isMyMessage"])):(l(),B(wa,{key:1,isMyMessage:e(_),message:n.message,onQuote:r[4]||(r[4]=R=>C("quote",R)),onToBuzz:r[5]||(r[5]=R=>C("toBuzz",R))},null,8,["isMyMessage","message"])),v(" Quout "),s.message.replyInfo?(l(),B(ol,qs({key:2,quote:{avatarImage:(Re=(Ee=s.message.replyInfo)==null?void 0:Ee.userInfo)==null?void 0:Re.avatarImage,metaName:"",metaId:(De=(He=s.message.replyInfo)==null?void 0:He.userInfo)==null?void 0:De.metaid,nickName:s.message.replyInfo.userInfo.name,protocol:s.message.replyInfo.protocol,content:(e(A)(s.message.replyInfo.protocol,e(L).SimpleFileMsg),s.message.replyInfo.content),encryption:s.message.replyInfo.encryption,timestamp:s.message.replyInfo.timestamp,isMock:s.message.isMock,index:s.message.replyInfo.index},isSession:!0},t.$attrs,{isMyMessage:e(_)}),null,16,["quote","isMyMessage"])):v("v-if",!0),a("div",{class:h(["flex",[e(_)?"flex-row-reverse":""]])},[x(y,{image:e(ue),"meta-id":"undefined",name:(Qe=(Ge=s.message)==null?void 0:Ge.fromUserInfo)==null?void 0:Qe.name,"meta-name":"",class:"w-10 h-10 lg:w-13.5 lg:h-13.5 shrink-0 select-none",disabled:!0},null,8,["image","name"]),a("div",{class:h(["grow",[e(_)?"mr-2 lg:mr-4 pl-8 lg:pl-12":"ml-2 lg:ml-4 pr-8 lg:pr-12"]])},[a("div",{class:h(["flex space-x-2",[e(_)?"flex-row-reverse items-center":"items-baseline"]])},[x(P,{name:(Oe=(Ve=s.message)==null?void 0:Ve.fromUserInfo)==null?void 0:Oe.name,"meta-name":"","text-class":"text-sm font-medium dark:text-gray-100",class:h([e(_)?"ml-2":""])},null,8,["name","class"]),a("div",{class:h(["text-xs shrink-0 flex whitespace-nowrap items-center",[e(_)?"flex-row-reverse  justify-center":"gap-1 ",e(p)==e(be).btc?"text-[#EBA51A]":"text-dark-300 dark:text-gray-400"]])},[a("span",null,d(e(Es)(s.message.timestamp,e(N))),1),a("div",La,[e(p)==e(be).btc?(l(),B(k,{key:0,name:"btc",class:h(["chain-icon-menu w-[16px] h-[16px]",e(_)?"mr-1":""])},null,8,["class"])):v("v-if",!0),v(` <img
              :src="btcIcon"
              
             
              
            /> `)])],2)],2),e(se)?(l(),c("div",Fa,[x(F,{src:e(ie)((We=s.message)==null?void 0:We.content,(Je=s.message)==null?void 0:Je.encryption,(Ye=s.message)==null?void 0:Ye.protocol,(Ke=s.message)==null?void 0:Ke.isMock,!0),customClass:"max-w-[80%] md:max-w-[50%] lg:max-w-[320px] py-0.5 object-scale-down"},null,8,["src"]),x(il,{class:"w-8 mt-1"})])):e(pe)?(l(),c("div",Aa,[a("div",{class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(k,{name:"message_follow",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.follow")),1)],2)])):e(xe)?(l(),c("div",Ua,[a("div",Xa,[a("div",ja,[x(F,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",qa,[a("div",Ea,d(s.message.memo),1),a("div",Ra,d(s.message.amountStr.split(".")[0]+" "+s.message.symbol),1)])]),a("div",Ha,[x(k,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",Da,d(t.$t("Talk.Messages.token_transfer")),1)])])])):e(o)?(l(),c("div",Ga,[a("div",Qa,[a("div",Va,[x(F,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",Oa,[a("div",Wa,d(s.message.memo),1),s.message.data?(l(),c("div",Ja," # "+d(s.message.data.tokenIndex),1)):v("v-if",!0)])]),a("div",Ya,[x(k,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",Ka,d(t.$t("Talk.Messages.nft_transfer")),1)])])])):e(i)?(l(),c("div",Za,[a("div",et,[x(b,{to:{name:"nftDetail",params:{tokenIndex:s.message.data.tokenIndex,genesis:(Ze=s.message.data)==null?void 0:Ze.genesis,codehash:(ea=s.message.data)==null?void 0:ea.codehash,chain:"mvc"}},class:"block rounded-xl p-4 bg-white dark:bg-gray-700 rounded-tl border border-solid border-blue-400 divide-y divide-dark-200 dark:divide-gray-600"},{default:D(()=>[a("div",at,[x(F,{src:s.message.icon,customClass:"h-15 w-15 rounded-md shrink-0",loading:"lazy"},null,8,["src"]),a("div",tt,[a("div",st,d(s.message.memo),1),s.message.data?(l(),c("div",lt," # "+d(s.message.data.tokenIndex),1)):v("v-if",!0)])]),a("div",rt,[a("div",nt,d(t.$t("Talk.Messages.price")),1),a("div",ot,d(e(te)),1)])]),_:1},8,["to"]),a("div",it,[x(k,{name:"message_token",class:"w-4 h-4 text-white"}),a("div",ct,d(t.$t("Talk.Messages.nft_buy")),1)])]),a("div",dt,d(t.$t("Talk.Messages.buy_tip")),1)])):e(ve)?(l(),c("div",mt,[a("div",{class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(k,{name:"message_repost",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.repost")),1)],2),s.message.data.rePostComment?(l(),c("div",ut,d(s.message.data.rePostComment),1)):v("v-if",!0)])):e(ne)?(l(),c("div",gt,[a("div",{class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(k,{name:"message_repost",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.repost_with_comment")),1)],2),s.message.data.content?(l(),c("div",pt,d(s.message.data.content),1)):v("v-if",!0)])):e($e)?(l(),c("div",vt,[a("div",{class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(k,{name:"message_like",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.like")),1)],2)])):e(ze)?(l(),c("div",xt,[a("div",{class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl rounded-tl flex items-center",e(_)?"bg-primary dark:text-gray-800":"bg-white dark:bg-gray-700"])},[x(k,{name:"message_comment",class:"w-4 h-4 mr-1.5"}),a("span",null,d(t.$t("Talk.Messages.comment")),1)],2),a("div",ft,d(s.message.data.content),1)])):e(ge)?(l(),c("div",{key:9,class:h(["w-full py-0.5 flex items-center",[e(_)?"flex-row-reverse":""]])},[a("div",{class:h(["w-fit max-w-[90%] md:max-w-[50%] lg:max-w-[235PX] max-h-[600PX] overflow-y-hidden rounded bg-transparent cursor-pointer transition-all duration-200",[s.message.error&&"opacity-50"]]),onClick:W},[x(F,{src:e(J),isPrivateChat:!0,chatPubkeyForDecrypt:e(H),customClass:"rounded py-0.5 object-scale-down"},null,8,["src","chatPubkeyForDecrypt"])],2),s.message.error?(l(),c("button",{key:0,class:"ml-3",title:e(V),onClick:ae},[x(k,{name:"arrow_path",class:"w-4 h-4 text-dark-400 dark:text-gray-200 hover:animate-spin-once"})],8,yt)):v("v-if",!0),e(ge)&&f.value?(l(),B(Rs,{key:1,to:"body"},[f.value?(l(),B(pl,{key:0,src:s.message.content,isPrivateChat:!0,chatPubkeyForDecrypt:e(H),onClose:r[6]||(r[6]=R=>f.value=!1)},null,8,["src","chatPubkeyForDecrypt"])):v("v-if",!0)])):v("v-if",!0)],2)):e(Se)?(l(),c("div",ht,d(e(de)),1)):e(Te)?(l(),c("div",{key:11,class:h(["w-full flex py-0.5",[e(_)?"flex-row-reverse":""]])},[a("div",kt,[a("div",bt,[a("img",{src:e(Ba),class:"h-12",loading:"lazy"},null,8,wt),a("div",_t,[a("div",Mt,d(t.$t("Talk.Channel.come_get_red_envelope")),1),a("div",Ct,d(e(me)),1)])]),It])],2)):e(K)?(l(),c(Y,{key:12},[v(" \u7FA4\u804A\u9080\u8BF7\u94FE\u63A5 "),a("div",{class:h(["w-full flex py-0.5",[e(_)?"flex-row-reverse":""]])},[a("div",{class:"max-w-full sm:max-w-[300px] shadow rounded-xl cursor-pointer transition-all duration-200 bg-white dark:bg-gray-700 hover:shadow-md group",onClick:ee},[a("div",Tt,[v(" \u7FA4\u5934\u50CF\u548C\u57FA\u672C\u4FE1\u606F "),a("div",St,[a("div",Pt,[x(E,{src:e(j).groupAvatar,alt:e(j).groupName,"custom-class":"w-12 h-12 min-w-12 min-h-12 rounded-full",size:48},null,8,["src","alt"])]),a("div",$t,[a("div",zt,d(e(j).groupName||"Group Chat"),1),a("div",Bt,d(((aa=n.message.userInfo)==null?void 0:aa.name)||"Someone")+" "+d(t.$t("share_group_invites")),1)])]),a("div",Nt,[a("div",Lt,d(t.$t("share_group_creator"))+": "+d(e(j).creator),1),e(j).memberCount>0?(l(),c("div",Ft,d(t.$t("share_group_member"))+": "+d(e(j).memberCount),1)):v("v-if",!0)]),v(" \u67E5\u770B\u7FA4\u7EC4\u6309\u94AE "),a("div",At,[a("div",Ut,d(t.$t("share_group_view")),1)])])])],2)],2112)):(l(),c("div",{key:13,class:h(["my-1.5 max-w-full flex",[e(_)?"flex-row-reverse":""]])},[U.value==="showing"?(l(),c("div",{key:0,class:h(["text-sm text-dark-800 dark:text-gray-100 font-normal p-3 rounded-xl transition-all duration-200",[e(p)==e(be).btc&&"btc-item",e(_)?"bg-primary dark:text-gray-800 rounded-tr":"not-mine bg-white dark:bg-gray-700 rounded-tl",s.message.error&&"bg-red-200 dark:bg-red-700 opacity-50"]])},[a("div",{class:"",innerHTML:m.value},null,8,Xt),a("div",jt,d(t.$t("Talk.Messages.translated")),1)],2)):(l(),c("div",{key:2,class:h(["flex items-center gap-2 text-sm text-dark-800 dark:text-gray-100 font-normal break-all p-3 rounded-xl transition-all duration-200",[e(p)==e(be).btc&&"btc-item",e(_)?"bg-primary dark:text-gray-800 rounded-tr":"not-mine bg-white dark:bg-gray-700 rounded-tl",s.message.error&&"bg-red-200 dark:bg-red-700 opacity-50"]])},[a("div",{class:"whitespace-pre-wrap",innerHTML:q(e(ie)((ta=s.message)==null?void 0:ta.content,(sa=s.message)==null?void 0:sa.encryption,(la=s.message)==null?void 0:la.protocol,(ra=s.message)==null?void 0:ra.isMock,!0))},null,8,qt),s.message.mockId&&!s.message.error?(l(),c("div",Et)):v("v-if",!0)],2)),s.message.error?(l(),c("button",{key:3,class:"ml-3 break-words flex items-center justify-center",title:e(V),onClick:ae},[(na=s.message)!=null&&na.error?(l(),c("span",Ht,d((oa=s.message)==null?void 0:oa.error),1)):v("v-if",!0),x(k,{name:"arrow_path",class:"w-4 h-4 flex-1 text-dark-400 dark:text-gray-200 hover:animate-spin-once"})],8,Rt)):v("v-if",!0)],2))],2)],2)],2)}}}),Gt=we(Dt,[["__scopeId","data-v-52d69d4e"]]),Qt="/chat/sub-channel.9be40439.svg",Vt={key:0,class:"broadcast-chat-header bg-white dark:bg-gray-700 text-dark-800 dark:text-white"},Ot=["onClick"],Wt={class:"broadcast-icon"},Jt=["src"],Yt={class:"broadcast-content"},Kt={class:"broadcast-title text-base"},Zt={key:0,class:"broadcast-description text-xs flex items-center"},es={class:"text-dark-300 dark:text-gray-400"},as={class:"text-dark-300 dark:text-gray-400"},ts={class:h(["main-border","primary"])},ss={key:1,class:h(["main-border","primary"])},ls=O({__name:"BroadcastChatHeader",setup(s){const C=oe(),n=xa(),S=u(()=>C.currSubChannels),N=(g,X,T)=>{let U=(T==null?void 0:T.substring(0,16))||"";switch(g){case Le.msg:return Qs(X,U);case Le.red:return X;case Le.img:return`[${n.t("new_msg_img")}]`;default:return""}},f=g=>{C.enterSubGroupChat(g)},w=g=>{if(!g.lastMessage||typeof g.lastMessage.index!="number")return 0;const X=C.getLastReadIndex(g.id),T=g.lastMessage.index-X;return Math.max(0,T)};return(g,X)=>{const T=ya,U=ha;return e(S).length>0?(l(),c("div",Vt,[(l(!0),c(Y,null,ke(e(S),m=>{var p,W,V,K,Z,ee;return l(),c("div",{class:"broadcast-chat-container",key:m.id,onClick:j=>f(m.id)},[a("div",Wt,[a("img",{src:e(Qt),alt:""},null,8,Jt)]),a("div",Yt,[a("div",Kt,d(m.name||"# Broadcast Chat"),1),(p=m.lastMessage)!=null&&p.sender?(l(),c("div",Zt,[a("span",es,d(((W=m.lastMessage)==null?void 0:W.senderName)||((K=(V=m.lastMessage)==null?void 0:V.sender)==null?void 0:K.slice(0,6))||"")+":",1),a("span",as,d(N((Z=m.lastMessage)==null?void 0:Z.type,(ee=m.lastMessage)==null?void 0:ee.content,m.id)),1)])):v("v-if",!0)]),w(m)>0?(l(),B(U,{key:0,value:w(m),class:"item",max:9999,"show-zero":!1},{default:D(()=>[a("div",ts,[x(T,{name:"arrow_right",class:"cursor-pointer hover:text-gray-700 w-8 h-8"})])]),_:2},1032,["value"])):(l(),c("div",ss,[x(T,{name:"arrow_right",class:"cursor-pointer hover:text-gray-700 w-8 h-8"})]))],8,Ot)}),128))])):v("v-if",!0)}}}),rs=we(ls,[["__scopeId","data-v-90151149"]]),ns=s=>(Be("data-v-9f0ad625"),s=s(),Ne(),s),os={class:"broadcast-chat-container"},is={class:"broadcast-icon hover:scale-110"},cs=ns(()=>a("div",{class:"broadcast-content"},[a("div",{class:"broadcast-title text-base"}," Back to Main Channel ")],-1)),ds=O({__name:"BroadcastChatHeaderBack",setup(s){const C=oe();u(()=>C.currSubChannels);const n=()=>{C.setActiveChannel(C.activeChannel.parentGroupId)};return(S,N)=>{var w;const f=ye;return((w=e(C).activeChannel)==null?void 0:w.type)==="sub-group"?(l(),c("div",{key:0,class:"broadcast-chat-header bg-white dark:bg-gray-700 text-dark-800 dark:text-white",onClick:n},[a("div",os,[a("div",is,[x(f,null,{default:D(()=>[x(e(Vs))]),_:1})]),cs])])):v("v-if",!0)}}}),ms=we(ds,[["__scopeId","data-v-9f0ad625"]]),Fe=s=>(Be("data-v-04ad0a4a"),s=s(),Ne(),s),us={key:0,class:"h-full overflow-y-hidden"},gs={class:"app-container"},ps={class:"loader"},vs=Fe(()=>a("div",{class:"spinner"},null,-1)),xs=[vs],fs={class:"w-10 h-10 min-h-10 min-w-10 bg-white dark:bg-gray-700 shadow-md rounded-full flex items-center justify-center"},ys={key:1,class:"w-10 h-10 min-h-10 min-w-10 bg-white dark:bg-gray-700 shadow-md rounded-full flex items-center justify-center"},hs={class:"loader"},ks=Fe(()=>a("div",{class:"spinner"},null,-1)),bs=[ks],ws=O({__name:"MessageList",emits:["quote"],setup(s,{expose:C,emit:n}){const S=M(!1),N=M(!1),f=M(!1),w=M(!1),g=M(null),X=M(null),T=M(null);M(0);const U=M(0),m=fa(),p=oe(),W=Os();Ws();const V=M(!1);Js();const K=M(""),Z=M(),ee=Ys(),j=M();Ks();const ae=M(!1),{activeChannel:H}=Zs(oe()),J=M(new Map),q=M(null),de=(o,i)=>{o&&o.$el?J.value.set(i.index||0,o.$el):o&&J.value.set(i.index||0,o)},me=()=>{q.value&&q.value.disconnect(),q.value=new IntersectionObserver(o=>{o.forEach(i=>{if(i.isIntersecting){const t=i.target,r=parseInt(t.getAttribute("data-message-index")||"0");p.activeChannelId&&r>=0&&p.setLastReadIndex(p.activeChannelId,r).catch(y=>{})}})},{root:g.value,rootMargin:"0px",threshold:0})},_=()=>{!q.value||(q.value.disconnect(),me(),J.value.forEach((o,i)=>{o&&q.value&&(o.setAttribute("data-message-index",i.toString()),q.value.observe(o))}))},ue=u(()=>{if(p.isInitialized){const o=p.activeChannel;return(o==null?void 0:o.type)==="private"?"session":o==null?void 0:o.type}return"group"}),te=(o=!1)=>Q(this,null,function*(){if(S.value||f.value)return;if(o){if(w.value)return;f.value=!0}else{if(N.value)return;S.value=!0}let i=0;o&&T.value&&(i=T.value.scrollHeight);const t=p.activeChannelMessages.length;try{o?yield p.loadMoreNewestMessages(p.activeChannelId):yield p.loadMoreMessages(p.activeChannelId)}catch(y){}yield _e();const r=p.activeChannelMessages.length;if(t===r&&(o?w.value=!0:N.value=!0),o&&T.value&&g.value){const y=T.value.scrollHeight;g.value.scrollTop=i-y}S.value=!1,f.value=!1,setTimeout(()=>{w.value=!1},1e3)}),se=u(()=>H.value&&H.value.lastMessage&&typeof H.value.lastMessage.index=="number"&&typeof H.value.lastReadIndex=="number"?H.value.lastMessage.index-H.value.lastReadIndex:0),ge=o=>{const i=o.target;if(i)try{Math.abs(i.scrollTop)<50&&!w.value&&!f.value&&te(!0),Math.abs(i.scrollTop)>500?ae.value=!0:ae.value=!1;const t=100;i.scrollHeight-Math.abs(i.scrollTop)-i.clientHeight<t&&te(!1).catch(r=>{})}catch(t){}},Te=o=>{const i=g.value;!i||o.deltaY>0&&Math.abs(i.scrollTop)<10&&!w.value&&!f.value&&te(!0)},Se=o=>{o.touches.length>0&&(U.value=o.touches[0].clientY)},Pe=o=>{const i=g.value;!i||o.touches.length===0||o.touches[0].clientY-U.value<0&&Math.abs(i.scrollTop)<10&&!w.value&&!f.value&&te(!0)},$e=()=>Q(this,null,function*(){if(m.isAuthorized)if(p.isInitialized)p.channels.length;else try{yield p.init()}catch(o){}}),pe=o=>{};el(()=>Q(this,null,function*(){yield $e(),me(),yield _e(),ka&&document.addEventListener("click",pe)})),al([()=>p.activeChannelMessages],([o])=>{o&&o.length>0&&_e(()=>{setTimeout(()=>{_()},100)})},{immediate:!0,deep:!0}),tl(()=>{ka&&document.removeEventListener("click",pe),q.value&&q.value.disconnect(),J.value.clear()}),u(()=>{var o,i;return p.activeChannelMessages[p.activeChannelMessages.length-1].index!==((i=(o=p.activeChannel)==null?void 0:o.lastMessage)==null?void 0:i.index)});const ve=()=>Q(this,null,function*(){se.value>0&&(yield p.loadNewestMessages(p.activeChannelId),yield _e(),yield sl(100)),g.value&&(g.value.scrollTop=0)});function ne(o){const i=J.value.get(o);if(i&&g.value){const t=g.value.getBoundingClientRect(),r=i.getBoundingClientRect().top-t.top+g.value.scrollTop;g.value.scrollTo({top:r-100,behavior:"smooth"}),setTimeout(()=>{i&&(i.classList.add("message-highlight-flash"),setTimeout(()=>{i.classList.remove("message-highlight-flash")},800))},500)}}function ze(o){const i=document.getElementById(o.toString());if(i&&j.value){const t=i.offsetTop-i.clientHeight;j.value.scrollTo({top:t,behavior:"smooth"}),setTimeout(()=>{i&&(i.classList.add("message-highlight-flash"),setTimeout(()=>{i.classList.remove("message-highlight-flash")},800))},500)}}function xe(o){return Q(this,null,function*(){const i=ll(),t={body:JSON.stringify(o),path:`bc1p20k3x2c4mglfxr5wa5sgtgechwstpld80kru2cg4gmm4urvuaqqsvapxu0:/protocols/${L.ShareChatMessage}`,flag:"metaid",version:"1.0.1",operation:"create",contentType:"application/json",encryption:"0",encoding:"utf-8"},r=yield ee.createPin(t,!0,!1).catch(y=>{i.close(),rl.error(y.message)});r?(i.close(),W.isShowShareSuccessModal=!0):r===null&&i.close()})}return C({scrollToIndex:ne,scrollToTimeStamp:ze,scrollToMessagesBottom:ve}),(o,i)=>{var P,k,F;const t=Ie,r=ye,y=ha;return l(),c(Y,null,[e(m).isAuthorized&&(e(W).isShowMessagesLoading||e(p).isInitialized===!1||e(p).activeChannelMessages.length===0&&((k=(P=e(p).activeChannel)==null?void 0:P.lastMessage)==null?void 0:k.index)>0)?(l(),c("div",us,[x(za)])):(l(),c("div",{key:1,class:"h-full relative overflow-y-auto",ref_key:"messagesScroll",ref:j,id:"messagesScroll"},[((F=e(H))==null?void 0:F.type)==="private"&&!e(H).publicKeyStr?(l(),B(t,{key:0,title:o.$t("user_private_chat_unsupport"),type:"error","show-icon":"",closable:!1},null,8,["title"])):v("v-if",!0),v(" \u5E7F\u64AD\u804A\u5929\u5934\u90E8 - \u5728\u6D88\u606F\u5217\u8868\u6700\u4E0A\u65B9\uFF08\u7B80\u5316\u7248\u63D0\u793A\uFF09 "),v(` <div v-if="_welComePage && layout.showWelcomeDescView">
      <div class="mt-20 px-1 flex text-center  items-center justify-center flex-col">
        <div class="">
          <Icon name="welcome_icon" class="w-[140px] h-[38px]"></Icon>
        </div>
        <div class="text-2xl welcome-desc text-zinc-800 mt-3 break-all flex items-center justify-center max-w-[326px]">
         <span>
          A Decentralized Messaging App Built on Bitcoin
         </span>
        </div>
        <div class="text-xl mt-5 text-zinc-600 break-all ">
          Fully Decentralized,Immutable,Uncensorable,and Unhackable
        </div>
        <div class="flex flex-col mt-5">
          <div class="font-medium flex flex-row items-center text-lg">
            <span>{{ $t('link.metaid.group') }}</span
            ><el-icon><CaretBottom /></el-icon>
          </div>
          <a class="main-border mt-5 text-lg primary p-3" @click="toMetaIdGrop">{{
            $t('MetaID.official_group')
          }}</a>
        </div>
      </div>
    </div> `),a("div",gs,[x(rs),x(ms),a("div",{class:"list-container",ref_key:"listContainer",ref:g,onScrollPassive:ge,onWheelPassive:Te,onTouchstartPassive:Se,onTouchmovePassive:Pe},[v(" \u9876\u90E8\u52A0\u8F7D\u6307\u793A\u5668 "),fe(a("div",ps,xs,512),[[he,S.value]]),v(" \u5217\u8868\u9879\u5C06\u88AB\u6E32\u67D3\u5230\u8FD9\u91CC "),v(" ref \u7528\u4E8E\u5728\u4EE3\u7801\u4E2D\u76F4\u63A5\u8BBF\u95EE\u8FD9\u4E2A DOM \u5143\u7D20 "),a("div",{ref_key:"listWrapper",ref:T},[v(" \u4F7F\u7528 v-for \u5FAA\u73AF\u6E32\u67D3\u5217\u8868\u9879 "),e(ue)==="group"||e(ue)==="sub-group"?(l(!0),c(Y,{key:0},ke(e(p).activeChannelMessages,b=>(l(),B(cl,{key:b.txId||b.timestamp,message:b,id:b.timestamp,"data-message-index":b.index,"data-message-mockId":b.mockId||"",ref_for:!0,ref:E=>de(E,b),onQuote:E=>n("quote",E),onToBuzz:xe,onToTimeStamp:ne},null,8,["message","id","data-message-index","data-message-mockId","onQuote"]))),128)):(l(!0),c(Y,{key:1},ke(e(p).activeChannelMessages,b=>(l(),B(Gt,{key:b.txId||b.timestamp,message:b,"data-message-mockId":b.mockId||"","data-message-index":b.index,ref_for:!0,ref:E=>de(E,b),onQuote:E=>n("quote",E),id:b.timestamp,onToBuzz:xe,onToTimeStamp:ne},null,8,["message","data-message-mockId","data-message-index","onQuote","id"]))),128)),x(va,{name:"fade-scroll-button",mode:"out-in",persisted:""},{default:D(()=>[fe(a("div",{class:"scroll-to-bottom-button cursor-pointer",onClick:i[0]||(i[0]=b=>ve())},[e(se)>0?(l(),B(y,{key:0,value:e(se),class:"item",max:9999,"show-zero":!1},{default:D(()=>[a("div",fs,[x(r,{class:"text-dark-800 dark:text-white"},{default:D(()=>[x(e(ba))]),_:1})])]),_:1},8,["value"])):(l(),c("div",ys,[x(r,{class:"text-dark-800 dark:text-white"},{default:D(()=>[x(e(ba))]),_:1})]))],512),[[he,ae.value||e(se)>0]])]),_:1})],512),a("div",{class:"message-list-bottom-spacer",ref_key:"bottomSpacer",ref:X},null,512),v(" \u5E95\u90E8\u52A0\u8F7D\u6307\u793A\u5668 "),fe(a("div",hs,bs,512),[[he,f.value]])],544)])],512)),x(dl,{modelValue:V.value,"onUpdate:modelValue":i[1]||(i[1]=b=>V.value=b),repostTxId:K.value,ref_key:"PublishRef",ref:Z},null,8,["modelValue","repostTxId"])],64)}}});_a=we(ws,[["__scopeId","data-v-04ad0a4a"]])}));export{hl as __tla,_a as default};
